

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Tutorials &mdash; vaspkit 1.2.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/style.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Release notes" href="changelog.html" />
    <link rel="prev" title="Installation" href="installation.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #cbdce3" >
          

          
            <a href="index.html">
          

          
            
            <img src="_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="features.html">Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Tutorials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#quick-start">1. Quick Start</a></li>
<li class="toctree-l2"><a class="reference internal" href="#generate-input-files">2. Generate Input Files</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#generate-incar">2.1 Generate INCAR</a></li>
<li class="toctree-l3"><a class="reference internal" href="#generate-kpoints">2.2 Generate KPOINTS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#generate-potcar">2.3 Generate POTCAR</a></li>
<li class="toctree-l3"><a class="reference internal" href="#generate-poscar">2.4 Generate POSCAR</a></li>
<li class="toctree-l3"><a class="reference internal" href="#input-file-self-check">2.5 Input File Self Check</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#band-structure">3 Band Structure</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pre-process-band-structure-pure-functional">3.1 Pre-process Band Structure (pure functional)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#example-single-layer-mos2">Example: Single-layer MoS2</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#post-process-band-structure-pure-functional">3.2 Post-process Band Structure (pure functional)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pre-process-band-structure-hybrid-functional">3.3 Pre-process Band Structure (hybrid functional)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#example-single-layer-mos2-1">Example: single layer MoS2</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#post-process-band-structure-hybrid-functional">3.4 Post-process Band Structure (hybrid functional)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#effective-mass">3.5 Effective Mass</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#example-single-layer-mos2-effective-mass">Example: Single Layer MoS2 effective mass</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#band-unfolding">3.6 Band-unfolding</a></li>
<li class="toctree-l3"><a class="reference internal" href="#d-band-structure">3.7 3D Band Structure</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#example-graphene-3d-band-structure">Example: Graphene 3D Band Structure</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#fermi-surface">3.8 Fermi Surface</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#example-cu-fermi-surface">Example: Cu Fermi Surface</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#transition-dipole-moment">3.9 Transition Dipole Moment</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#density-of-states">4 Density of States</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#extract-and-output-dos-and-pdos">4.1 Extract and output DOS and PDOS</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#example-pdos-of-co-adsorption-on-ni-100-surface">Example: PDOS of CO adsorption on Ni(100) surface.</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#d-band-center">4.2 <em>d</em>-band Center</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#thermo-energy-correction">5 Thermo Energy Correction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#gas-molecule-free-energy-correction">5.1 Gas Molecule Free Energy Correction</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#example-thermo-energy-correction-for-o2-molecule">Example: Thermo energy correction for O2 molecule:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#adsorbed-molecular-free-energy-correction">5.2 Adsorbed Molecular Free Energy Correction</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#example-thermo-energy-correction-for-adsorbed-o-on-au-111">Example: Thermo energy correction for adsorbed O on Au(111)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#elastic-properties">6 Elastic Properties</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#determine-elastic-constants-based-on-energy-strain-method">6.1 Determine elastic constants based on energy-strain method</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#optic-properties">7 Optic Properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="#structure-and-symmetry-tools">8 Structure and Symmetry Tools</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#redefine-lattice">8.1 Redefine Lattice</a></li>
<li class="toctree-l3"><a class="reference internal" href="#build-supercell">8.2 Build Supercell</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fix-atoms-by-layers">8.3 Fix Atoms by Layers</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fix-atoms-by-height">8.4 Fix Atoms by Height</a></li>
<li class="toctree-l3"><a class="reference internal" href="#swap-axis-of-lattice-vector">8.5 Swap Axis of Lattice Vector</a></li>
<li class="toctree-l3"><a class="reference internal" href="#symmetry-tools">8.6 Symmetry Tools</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#potential-related">9 Potential related</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#planar-average-potential">9.1 Planar Average Potential</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#example-work-function-of-au-111-slab-with-five-atomic-layers">Example, Work-function of Au(111) slab with five atomic layers.</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#macroscopic-averaged-potential">9.2 Macroscopic Averaged Potential</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#density-related">10 Density related</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#charge-density-and-spin-density">10.1 Charge Density and Spin Density</a></li>
<li class="toctree-l3"><a class="reference internal" href="#charge-density-difference">10.2 Charge Density Difference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#example-charge-density-difference-of-two-fragments">Example: Charge density difference of two fragments</a></li>
<li class="toctree-l4"><a class="reference internal" href="#example-deformation-charge-density-of-co">Example: Deformation charge density of CO</a></li>
<li class="toctree-l4"><a class="reference internal" href="#example-charge-density-difference-of-inse-with-electric-field">Example: Charge density difference of InSe with electric field</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#wavefunction-visualization-in-real-space">10.3 WaveFunction Visualization in Real-Space</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#example-wavefunction-of-co-molecule">Example: WaveFunction of CO molecule</a></li>
<li class="toctree-l4"><a class="reference internal" href="#example-wavefunction-of-mos2-ws2-heterojuctions">Example: WaveFunction of MoS2/WS2 Heterojuctions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#other-functions">11 Other Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#molecular-dynamics-process">11.1 Molecular Dynamics process</a></li>
<li class="toctree-l3"><a class="reference internal" href="#file-format-transfer">11.2 File Format Transfer</a></li>
<li class="toctree-l3"><a class="reference internal" href="#user-interface">11.3 USER interface</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Release notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="gallery.html">Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="citations.html">Citations</a></li>
<li class="toctree-l1"><a class="reference internal" href="contact.html">Bug report</a></li>
<li class="toctree-l1"><a class="reference internal" href="acknowledgments.html">Acknowledgments</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">vaspkit</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Tutorials</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="tutorials">
<h1>Tutorials<a class="headerlink" href="#tutorials" title="Permalink to this headline">¶</a></h1>
<div class="section" id="quick-start">
<h2>1. Quick Start<a class="headerlink" href="#quick-start" title="Permalink to this headline">¶</a></h2>
<p>There are at lease five ways to run vaspkit under either the interactive user interface or command line mode. We take the generation of KPOINTS (task 102) as an example to illustrate the useage of vaspkit.</p>
<ol class="arabic simple">
<li><p>Just type <code class="docutils literal notranslate"><span class="pre">vaspkit</span></code> in the terminal to launch the interactive user interface mode;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">vaspkit</span> <span class="pre">-task</span> <span class="pre">102</span> <span class="pre">-kpr</span> <span class="pre">0.04</span></code> to generate KPOINTS file with a reciprocal space resolution of <span class="math notranslate nohighlight">\(2\pi \times 0.04\)</span> <span class="math notranslate nohighlight">\(Å^{-1}\)</span>. More details can be get by run <code class="docutils literal notranslate"><span class="pre">vaspkit</span> <span class="pre">-help</span></code>. <strong>Note that part of the functions is implemented</strong>;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">-e</span> <span class="pre">&quot;102\n2\n0.04\n&quot;|</span> <span class="pre">vaspkit</span></code>;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;(echo</span> <span class="pre">102;</span> <span class="pre">echo</span> <span class="pre">2;</span> <span class="pre">echo</span> <span class="pre">0.04)|vaspkit</span></code>;</p></li>
<li><p>vi cmd.in (any file name if you want) including the following content:</p></li>
</ol>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>102
2
0.04
</pre></div>
</div>
<p>and then run <code class="docutils literal notranslate"><span class="pre">vaspkit</span> <span class="pre">&lt;cmd.in</span></code>.</p>
<p>if one wants to run vaspkit in batch mode, for example, to generate KPOINTS file in several sub-olders:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>for i in `ls`
do echo ${i}
    cd ${i}
    vaspkit -task 102 -file POSCAR -kpr 0.04
    cd ..
done
</pre></div>
</div>
<p>Or use <code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">-e</span></code> command to input for VASPKIT:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>echo -e &quot;102\n2\n0.04&quot; | vaspkit
</pre></div>
</div>
<p>means input <code class="docutils literal notranslate"><span class="pre">102</span></code>, <code class="docutils literal notranslate"><span class="pre">2</span></code>, <code class="docutils literal notranslate"><span class="pre">0.04</span></code> in turn in VASPKIT.</p>
</div>
<div class="section" id="generate-input-files">
<h2>2. Generate Input Files<a class="headerlink" href="#generate-input-files" title="Permalink to this headline">¶</a></h2>
<p>In order to perform a VASP calculation, usually one needs 4 files, INCAR,
POSCAR, POTCAR and KPOINTS.</p>
<ol class="arabic simple">
<li><p>INCAR contains all keywords and tells VASP what to calculate;</p></li>
<li><p>POSCAR contains lattice parameters, atomic coordinates information,
and atomic velocity information (for MD);</p></li>
<li><p>POTCAR is a pseudo potential file, which is USPP or PAW type;</p></li>
<li><p>KPOINTS, which can be included in INCAR, but not recommended for
omitting. It contains K-points information in the reciprocal space at
which the wave function integrates to obtain the charge density.</p></li>
</ol>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>101) Customize INCAR File
102) Generate KPOINTS File for SCF Calculation
103) Generate POTCAR File with Default Setting
104) Generate POTCAR File with User Specified Potential
105) Generate POSCAR File from cif (no fractional occupations)
106) Generate POSCAR File from Material Studio xsd (retain fixes)
107) Reformat POSCAR File in Specified Order of Elements
108) Successive Procedure to Generate VASP Files and Check
109) Check All VASP Files
</pre></div>
</div>
<div class="section" id="generate-incar">
<h3>2.1 Generate INCAR<a class="headerlink" href="#generate-incar" title="Permalink to this headline">¶</a></h3>
<p>Run VASPKIT in the directory containing POSCAR. Enter <code class="docutils literal notranslate"><span class="pre">1</span></code> to select
the function VASP Input Files Generator, and then enter <code class="docutils literal notranslate"><span class="pre">101</span></code>to
select customize INCAR File, you will get the following display
information:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>101
 +-------------------------- Warm Tips --------------------------+
                You MUST Know What You Are Doing
  Some Parameters in INCAR File Neet To Be Set/Adjusted Manually
 +---------------------------------------------------------------+
 ======================== INCAR Options ==========================
 ST) Static-Calculation            SR) Standard Relaxation
 MG) Magnetic Properties           SO) Spin-Orbit Coupling
 D3) DFT-D3 no-damping Correction  H6) HSE06 Calculation
 PU) DFT+U Calculation             MD) Molecular Dynamics
 GW) GW0 Calculation               BS) BSE Calculation
 DC) Elastic Constant              EL) ELF Calculation
 BD) Bader Charge Analysis         OP) Optical Properties
 EC) Static Dielectric Constant    PC) Decomposed Charge Density
 FD) Phonon-Finite-Displacement    DT) Phonon-DFPT
 NE) Nudged Elastic Band (NEB)     DM) The Dimer Method
 FQ) Frequence Calculations        LR) Lattice Relaxation

 0)   Quit
 9)   Back
 ------------&gt;&gt;
 Input Key-Parameters (STH6D3 means HSE06-D3 Static-Calcualtion)
</pre></div>
</div>
<p>Enter the words for specific task. The generated INCAR file will contain
corresponding keywords that are required for this task.</p>
<p>For example, to do a single-point calculation (<code class="docutils literal notranslate"><span class="pre">ST</span></code>) with hybrid
functional HSE06 (<code class="docutils literal notranslate"><span class="pre">H6</span></code>) and DFT-D3 (<code class="docutils literal notranslate"><span class="pre">D3</span></code>) vdW correction, enter
<code class="docutils literal notranslate"><span class="pre">STH6D3</span></code>.</p>
<p>If enter <code class="docutils literal notranslate"><span class="pre">LR</span></code>, one will get a INCAR for lattice relaxation task with
detail comments:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Global Parameters
  ISTART =  1            (Read existing wavefunction; if there)
  # ISPIN =  2           (Spin polarised DFT)
  # ICHARG =  11         (Non-self-consistent: GGA/LDA band structures)
  LREAL  = Auto          (Projection operators: automatic)
  # ENCUT  =  400        (Cut-off energy for plane wave basis set, in eV)
  PREC   =  Normal       (Precision level)
  LWAVE  = .TRUE.        (Write WAVECAR or not)
  LCHARG = .TRUE.        (Write CHGCAR or not)
  ADDGRID= .TRUE.        (Increase grid; helps GGA convergence)
  # LVTOT  = .TRUE.      (Write total electrostatic potential into LOCPOT or not)
  # LVHAR  = .TRUE.      (Write ionic+Hartree electrostatic potential into LOCPOT or not)
  # NELECT =             (No. of electrons: charged cells; be careful)
  # LPLANE = .TRUE.      (Real space distribution; supercells)
  # NPAR   = 4           (Max is no. nodes; don&#39;t set for hybrids)
  # NWRITE = 2           (Medium-level output)
  # KPAR   = 2           (Divides k-grid into separate groups)
  # NGX    = 500         (FFT grid mesh density for nice charge/potential plots)
  # NGY    = 500         (FFT grid mesh density for nice charge/potential plots)
  # NGZ    = 500         (FFT grid mesh density for nice charge/potential plots)

Lattice Relaxation
  NSW    =  300          (number of ionic steps)
  ISMEAR =  0            (gaussian smearing method )
  SIGMA  =  0.05         (please check the width of the smearing)
  IBRION =  2            (Algorithm: 0-MD; 1-Quasi-New; 2-CG)
  ISIF   =  3            (optimize atomic coordinates and lattice parameters)
  EDIFFG = -1.5E-02      (Ionic convergence; eV/AA)
  PREC   =  Accurate     (Precision level)
</pre></div>
</div>
<p>If one want a cleaner INCAR without comments, set the <code class="docutils literal notranslate"><span class="pre">~/.vaspkit</span></code>
file with:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>MINI_INCAR               .TRUE.
</pre></div>
</div>
<p>The automatic generated INCAR for lattice relaxation task will be:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Global Parameters
  ISTART = 1
  LREAL = Auto
  PREC = Normal
  LWAVE = .TRUE.
  LCHARG = .TRUE.
  ADDGRID= .TRUE.

Lattice Relaxation
  NSW = 300
  ISMEAR = 0
  SIGMA = 0.05
  IBRION = 2
  ISIF = 3
  EDIFFG = -1.5E-02
  PREC = Accurate
</pre></div>
</div>
<p>Users can also modify some parameters as they want from these INCAR
file.</p>
<p>If there is already an INCAR file, the original INCAR will be
overwritten as default. Edit the <code class="docutils literal notranslate"><span class="pre">~/.vaspkit</span></code> to change the INCAR
output settings. Simply change the <code class="docutils literal notranslate"><span class="pre">SET_INCAR_WRITE_MODE</span></code> line.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>SET_INCAR_WRITE_MODE     OVERRIDE   #  OVERRIDE, APPEND,BACK-UP-OLD,BACK-UP-NEW;
</pre></div>
</div>
<table class="docutils align-default">
<colgroup>
<col style="width: 19%" />
<col style="width: 81%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>OVERRIDE</p></th>
<th class="head"><p>New content added to the tail of original INCAR</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>APPEND</p></td>
<td><p>New content added to the tail of old INCAR</p></td>
</tr>
<tr class="row-odd"><td><p>BACK-UP-OLD</p></td>
<td><p>back up the new INCAR</p></td>
</tr>
<tr class="row-even"><td><p>BACK-UP-NEW</p></td>
<td><p>the new INCAR to INCAR.new</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="generate-kpoints">
<h3>2.2 Generate KPOINTS<a class="headerlink" href="#generate-kpoints" title="Permalink to this headline">¶</a></h3>
<p>For self-consistent calculation, users need to prepare a KPOINTS file to
specify density of K-points and the method for automatic k-mesh
generation.</p>
<p>VASPKIT can generate KPOINTS file automatically with pre-exist POSCAR
file. Run VASPKIT option <code class="docutils literal notranslate"><span class="pre">1)</span> <span class="pre">VASP</span> <span class="pre">Input</span> <span class="pre">Files</span> <span class="pre">Generator</span></code>, then enter
option <code class="docutils literal notranslate"><span class="pre">102</span></code> to generate KPOINTS file for SCF calculation. Then input
the K-mesh scheme according to the following display information:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>102
 ======================= K-Mesh Scheme ==========================
 1) Monkhorst-Pack Scheme
 2) Gamma Scheme

 0)   Quit
 9)   Back
 -------------&gt;&gt;
</pre></div>
</div>
<p>Enter <code class="docutils literal notranslate"><span class="pre">1</span></code> to select the original Monkhorst-Pack scheme,</p>
<p>Enter <code class="docutils literal notranslate"><span class="pre">2</span></code> to select the Gamma centered Monkhorst-Pack scheme.</p>
<p>Then, VASPKIT will ask us to input KPT-Resolved Value between K-points
in reciprocal cell in units of <span class="math notranslate nohighlight">\(2\pi \times 0.04 Å^{-1}\)</span>.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>2
  --&gt;&gt; (01) Reading Structural Parameters from POSCAR File...
 +-------------------------- Warm Tips --------------------------+

 * Accuracy Levels: Gamma-Only: 0;
    Low: 0.06~0.04;
    Medium: 0.04~0.03;
    Fine: 0.02-0.01.
 * 0.03-0.04 is Generally Precise Enough!
   +---------------------------------------------------------------+
    Input KPT-Resolved Value (e.g., 0.04, in unit of 2*PI/Angstrom):
    ------------&gt;&gt;
</pre></div>
</div>
<p>Number of K-points increases when the KPT-resolved value (kpr) decreases.
Number of K-points decreases when the kpr value increase. For
each direction, the number is determined by</p>
<div class="math notranslate nohighlight">
\[N=\max \left(1,\left|\vec{b}_{i}\right| / \mathrm{kpr}\right)\]</div>
<p>where <span class="math notranslate nohighlight">\(\vec{b}_{i}\)</span> are the reciprocal lattice vectors. These
values are rounded to the next integer greater than or equal to <strong>N</strong>.
The recommend value ~0.04 (<span class="math notranslate nohighlight">\(2\pi \times 0.04 Å^{-1}\)</span>) is enough for most
system. This parameter is similar as the parameter KSPACING in INCAR.
But the unit is different. Unit of KSPACING is <span class="math notranslate nohighlight">\(Å^{-1}\)</span>, and the unit of
VASPKIT is <span class="math notranslate nohighlight">\(2\pi \times 0.04 Å^{-1}\)</span>.</p>
<p>The first line of output KPOINTS file show the users’ defined
KPT-Resolved Value.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>K-Mesh Generated with KP-Resolved Value (...): 0.020
0
Gamma
  14  14  14
0.0  0.0  0.0
</pre></div>
</div>
</div>
<div class="section" id="generate-potcar">
<h3>2.3 Generate POTCAR<a class="headerlink" href="#generate-potcar" title="Permalink to this headline">¶</a></h3>
<p>When generating KPOINTS, POTCAR will also be generate automatically. Or
run VASPKIT <code class="docutils literal notranslate"><span class="pre">103</span></code> to generate POTCAR.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>103
  --&gt;&gt; (01) Reading Structural Parameters from POSCAR File...
  --&gt;&gt; (02) Written POTCAR File with the Standard Potential!
</pre></div>
</div>
<p>It reads the elements information from POSCAR and combines the
corresponding POTCAR from the pseudo potential folders that you set in
<code class="docutils literal notranslate"><span class="pre">~/.vaspkit</span></code>.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>GGA_PATH                 &#39;~/POTCAR/GGA&#39;     #  Path of GGA potential.
PBE_PATH                 &#39;~/POTCAR/PBE&#39;     #  Path of PBE potential.
LDA_PATH                 &#39;~/POTCAR/LDA&#39;     #  Path of LDA potential.
POTCAR_TYPE               PBE               #  PBE, GGA or LDA;
RECOMMENDED_POTCAR       .TRUE.             # .TRUE. or .FALSE.;
</pre></div>
</div>
<p>Set <code class="docutils literal notranslate"><span class="pre">POTCAR_TYPE</span></code> to <code class="docutils literal notranslate"><span class="pre">PBE</span></code>, <code class="docutils literal notranslate"><span class="pre">GGA</span></code>, or<code class="docutils literal notranslate"><span class="pre">LDA</span></code> as you want. The
<code class="docutils literal notranslate"><span class="pre">RECOMMENDED_POTCAR</span></code> tag control whether to use recommended potentials
from VASP manual (Page. 195, 2018.10.29,
<a class="reference external" href="http://cms.mpi.univie.ac.at/vasp/vasp/Recommended_PAW_potentials_DFT_calculations_using_vasp_5_2.html">http://cms.mpi.univie.ac.at/vasp/vasp/Recommended_PAW_potentials_DFT_calculations_using_vasp_5_2.html</a>).
If <code class="docutils literal notranslate"><span class="pre">RECOMMENDED_POTCAR</span></code> is <code class="docutils literal notranslate"><span class="pre">.FALSE.</span></code>, POTCAR with no extensions will
be used. If <code class="docutils literal notranslate"><span class="pre">RECOMMENDED_POTCAR</span></code> is <code class="docutils literal notranslate"><span class="pre">.TRUE.</span></code>, official recommended
POTCAR will be used.</p>
<p>POTCAR types:</p>
<ol class="arabic simple">
<li><p>No extensions “_”</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_d</span></code>. An extension d, treat the <em>d</em> semi core states as valence
state.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_pv</span></code> or <code class="docutils literal notranslate"><span class="pre">_sv</span></code>. The extensions <code class="docutils literal notranslate"><span class="pre">_pv</span></code> and <code class="docutils literal notranslate"><span class="pre">_sv</span></code> imply that the
<em>p</em> and <em>s</em> semi-core states are treated as valence states.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_h</span></code> and <code class="docutils literal notranslate"><span class="pre">_s</span></code>. An extension <code class="docutils literal notranslate"><span class="pre">_h</span></code> or<code class="docutils literal notranslate"><span class="pre">_s</span></code> implies that the
potential is harder or softer than the standard potential and hence
requires a higher or lower energy cutoff.</p></li>
<li><p>Pseudo hydrogen. ex: <code class="docutils literal notranslate"><span class="pre">H.5</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_GW</span></code>. Used for GW calculation.</p></li>
</ol>
<p>If one want to generate POTCAR for GW calculation, Set the <code class="docutils literal notranslate"><span class="pre">GW_POTCAR</span></code>
to .TRUE. in <code class="docutils literal notranslate"><span class="pre">~/.vaspkit</span></code>.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>GW_POTCAR                .TRUE.            # .TRUE. or .FALSE.;
</pre></div>
</div>
<p>VASPKIT also provide <code class="docutils literal notranslate"><span class="pre">104</span></code> option to generate POTCAR manually by
selecting the type of potential for each element.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>104
 --&gt;&gt; (1) Reading Structural Parameters from POSCAR File...
 Auto detected POTCAR_TYPE is O, please type the one you want!
O_h
 Auto detected POTCAR_TYPE is Ti, please type the one you want!
Ti_sv
 --&gt;&gt; (2) Written POTCAR File with user specified Potential!
</pre></div>
</div>
<p>In this example, enter the customized type of potentials O and Ti.
<code class="docutils literal notranslate"><span class="pre">Ti_sv</span></code> was chosen for Ti and <code class="docutils literal notranslate"><span class="pre">O_h</span></code> was chosen for O. If there is no
user defined potential type in the list of potentials, VASPKIT will ask
user re-enter.</p>
</div>
<div class="section" id="generate-poscar">
<h3>2.4 Generate POSCAR<a class="headerlink" href="#generate-poscar" title="Permalink to this headline">¶</a></h3>
<p>VASPKIT can transform .cif and .xsd (Materials Studio format) files to
POSCAR format by option <code class="docutils literal notranslate"><span class="pre">105</span></code> and <code class="docutils literal notranslate"><span class="pre">106</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">105</span></code> will call <code class="docutils literal notranslate"><span class="pre">/vaspkit.1.00/utilities/cif2pos.py</span></code> script.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>105
 Please type in the filename of cif-&gt;
al2o3.cif
Pleas input the order of element, `ENTER` for default!
Example: &#39;Al O&#39; in this CIF

  --&gt;&gt; (01) POSCAR has been generated...
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">106</span></code> will call <code class="docutils literal notranslate"><span class="pre">/vaspkit.1.00/utilities/xsd2pos.py</span></code> script
automatically. Note that the atom fix information in .xsd file is kept
when transform.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>106
 Build-&gt;Symmetry-&gt;Make P1,then select atoms to be fixed, Modify-&gt;Constraints-&gt;fi
 x fractional position-&gt;
 Please type in the filename of xsd-&gt;
CONTCAR-n2-3.xsd
  --&gt;&gt; (01) POSCAR has been generated...
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">107</span></code> can reorder the elements in POSCAR file.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>107
  --&gt;&gt; (01) Reading Structural Parameters from POSCAR File...
 Please Type the New Order of Elements to Sort.
 (Tip: The Initial Order of Elements in POSCAR File is: Al  O)
 -------------&gt;&gt;
O Al
  --&gt;&gt; (02) Written POSCAR_REV File!
</pre></div>
</div>
</div>
<div class="section" id="input-file-self-check">
<h3>2.5 Input File Self Check<a class="headerlink" href="#input-file-self-check" title="Permalink to this headline">¶</a></h3>
<p>VASPKIT can do format correction and pseudo potential check by option
<code class="docutils literal notranslate"><span class="pre">109</span></code>. VASPKIT will automatically correct the INCAR and POSCAR formats
and check if the POTCAR and POSCAR are consistent.</p>
</div>
</div>
<div class="section" id="band-structure">
<h2>3 Band Structure<a class="headerlink" href="#band-structure" title="Permalink to this headline">¶</a></h2>
<p>VASPKIT is very powerful at pre- and post- process VASP band structure
calculation.</p>
<div class="section" id="pre-process-band-structure-pure-functional">
<h3>3.1 Pre-process Band Structure (pure functional)<a class="headerlink" href="#pre-process-band-structure-pure-functional" title="Permalink to this headline">¶</a></h3>
<p>To do band structure calculation, one need to prepare a primitive cell
and corresponding K points path (K-path) alone Irreducible Brillouin
Zone. Irreducible Brillouin Zone is the first Brillouin zone reduced by
all of the symmetries in the points group of the lattice (point group of
the crystal). Recognize and select high symmetry points, and link them
along edges of Irreducible Brillouin Zone.</p>
<p>For example, conventional FCC metal cell, Irreducible Brillouin Zone,
and high symmetry points:</p>
<a class="reference internal image-reference" href="_images/kpath_3d_1.png"><img alt="_images/kpath_3d_1.png" class="align-center" src="_images/kpath_3d_1.png" style="width: 468.0px; height: 330.0px;" /></a>
<p>Conventional BCC metal cell, Irreducible Brillouin Zone, and high
symmetry points:</p>
<a class="reference internal image-reference" href="_images/kpath_3d_2.png"><img alt="_images/kpath_3d_2.png" class="align-center" src="_images/kpath_3d_2.png" style="width: 495.59999999999997px; height: 333.0px;" /></a>
<p>K-path is not unique. Usually, It is unnecessary to select all lines
between all the high symmetry points. Representative and important line
are selected and written as line-mode in KPOINTS file. For large-scale
and high-throughout calculation, there should be a rule to define the
path from structural information. pymatgen and seeK-path provide some
solutions but only can be used for 3D system. VASPKIT provide a tool to
generate K-path for 1D  (task <code class="docutils literal notranslate"><span class="pre">301</span></code>), 2D  (task <code class="docutils literal notranslate"><span class="pre">302</span></code>), and 3D (task <code class="docutils literal notranslate"><span class="pre">303</span></code>) materials based on a systematic rule:</p>
<p>Here are Brillouin zones for 2D materials (<a class="reference external" href="https://arxiv.org/abs/1806.04285">V. Wang, Y.-Y. Liang, Y. Kawazeo, W.-T. Geng, High-Throughput Computational Screening of Two-Dimensional Semiconductors, arXiv:1806.04285.</a>)</p>
<a class="reference internal image-reference" href="_images/kpath_2d.png"><img alt="_images/kpath_2d.png" class="align-center" src="_images/kpath_2d.png" style="width: 748.2px; height: 323.20000000000005px;" /></a>
<p>Other ways to get K-path automatically by using pymatgen（<a class="reference external" href="https://pymatgen.org/">https://pymatgen.org/</a>）Computational Materials Science 49
(2010) 299–312.
seek-path（<a class="reference external" href="https://www.materialscloud.org/work/tools/seekpath">https://www.materialscloud.org/work/tools/seekpath</a>）Computational
Materials Science 128 (2017) 140–184.</p>
<p>For the suggested k-paths of bulk materials, VASPKIT uses the same algorithm as seek-path website (<a class="reference external" href="http://dx.doi.org/10.1016/j.commatsci.2016.10.015">Y. Hinuma, G. Pizzi, Y. Kumagai, F. Oba, I. Tanaka, Band structure
diagram paths based on crystallography, Comp. Mat. Sci. 128, 140 (2017).</a>
).</p>
<div class="section" id="example-single-layer-mos2">
<h4>Example: Single-layer MoS2<a class="headerlink" href="#example-single-layer-mos2" title="Permalink to this headline">¶</a></h4>
<p>Band structure of single-layer MoS2 without spin polarization without
spin-orbital coupling.</p>
<ol class="arabic simple">
<li><p>Prepare MoS2 POSCAR.</p></li>
</ol>
<p>Because the K-path that generated by VASPKIT is based on standardized
primitive cell, so please first standardize the POSCAR. For 2D material:
Keep the center of z coordinates of 2D material at |<strong>c</strong>|/2.
(i.e. fractional coordinate z = 0.5 ). This could be accomplished by
VASPKIT <code class="docutils literal notranslate"><span class="pre">921</span></code> or <code class="docutils literal notranslate"><span class="pre">923</span></code>. VASPKIT <code class="docutils literal notranslate"><span class="pre">923</span></code> standardizes 2D crystal
cell，(i) put the vacuum layer at z direction，(ii) put the 2D material
to the center of z coordination：</p>
<p>For 3D material, use VASPKIT <code class="docutils literal notranslate"><span class="pre">602</span></code> to generate a standardized
primitive cell, <code class="docutils literal notranslate"><span class="pre">PRIMCELL.vasp</span></code>, and replace the original POSCAR.</p>
<p>Here the standardized POSCAR of MoS2 :</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>MoS2
1.0
        3.1659998894         0.0000000000         0.0000000000
       -1.5829999447         2.7418363326         0.0000000000
        0.0000000000         0.0000000000        18.4099998474
    S   Mo
    2    1
Direct
     0.000000000         0.000000000         0.413899988
     0.000000000         0.000000000         0.586099982
     0.666666687         0.333333343         0.500000000
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>92
 +-------------------------- Warm Tips --------------------------+
             Please Use These Features with CAUTION!
 +---------------------------------------------------------------+
 ===================== 2D Materials Toolkit ======================
 921) Center Aomic-Layer along z direction
 922) Resize Vacuum Thickness
 923) Standardize 2D Crystal Cell
 926) Elastic Constants for 2D Materials
 927) Valence and Conduction Band Edges Referenced to Vacuum Level
 929) Summary for Relaxed 2D Structure

 0)   Quit
 9)   Back
 ------------&gt;&gt;
923
 --&gt;&gt; (1) Reading Structural Parameters from POSCAR File...
 --&gt;&gt; (2) Written POSCAR_NEW File!
</pre></div>
</div>
<p>Do geometry optimization, and then do a single-point
self-consistent calculation to get the CHGCAR.</p>
<p>In a new folder run VASPKIT <code class="docutils literal notranslate"><span class="pre">302</span></code>, get 2D K-path files: (Note:
please check the Space Group)</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>302
 +-------------------------- Warm Tips --------------------------+
     See An Example in vaspkit/examples/seek_kpath/graphene_2D.
 This feature is still experimental &amp; check the PRIMCELL.vasp file.
 +---------------------------------------------------------------+
 --&gt;&gt; (1) Reading Structural Parameters from POSCAR File...
 +-------------------------- Summary ----------------------------+
           The vacuum slab is supposed to be along c axis
                           Prototype: AB2
           Total Atoms in Input Cell:   3
     Lattice Constants in Input Cell:   3.166   3.166  18.410
        Lattice Angles in Input Cell:  90.000  90.000 120.000
       Total Atoms in Primitive Cell:   3
 Lattice Constants in Primitive Cell:   3.166   3.166  18.410
    Lattice Angles in Primitive Cell:  90.000  90.000 120.000
                  2D Bravais Lattice: Hexagonal
                         Space Group: 187
                         Point Group: 26 [ D3h ]
                       International: P-6m2
                 Symmetry Operations:  12
                    Suggested K-Path: (shown in the next line)
 [ GAMMA-M-K-GAMMA ]
 +---------------------------------------------------------------+
 --&gt;&gt; (2) Written PRIMCELL.vasp file.
 --&gt;&gt; (3) Written KPATH.in File for Band-Structure Calculation.
 --&gt;&gt; (4) Written HIGH_SYMMETRY_POINTS File for Reference.
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">KPATH.in</span></code> file include line-mode K-path. Copy it to KPOINTS is OK.
<code class="docutils literal notranslate"><span class="pre">cp</span> <span class="pre">KPATH.in</span> <span class="pre">KPOINTS</span></code> . The default intersections is 20.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>K-Path Generated by VASPKIT
   20
Line-Mode
Reciprocal
   0.0000000000   0.0000000000   0.0000000000     GAMMA
   0.5000000000   0.0000000000   0.0000000000     M

   0.5000000000   0.0000000000   0.0000000000     M
   0.3333333333   0.3333333333   0.0000000000     K

   0.3333333333   0.3333333333   0.0000000000     K
   0.0000000000   0.0000000000   0.0000000000     GAMMA
</pre></div>
</div>
<p>HIGH_SYMMETRY_POINTS include the information of all high symmetry
points. VASPKIT do NOT promise the K-path is right, please compare the
results from seeK-path
website（<a class="reference external" href="https://www.materialscloud.org/work/tools/seekpath">https://www.materialscloud.org/work/tools/seekpath</a>）</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>High-symmetry points (in fractional coordinates). You can check them with the seekpath database [https://www.materialscloud.org/work/tools/seekpath].
   0.0000000000   0.0000000000   0.0000000000     GAMMA
   0.3333333333   0.3333333333   0.0000000000     K
   0.5000000000   0.0000000000   0.0000000000     M


If you use this module, please cite the following work:
[1] V. Wang, N. Xu, VASPKIT: A Pre- and Post-Processing Program for the VASP Code. http://vaspkit.sourceforge.net.
[2] V. Wang, Y.-Y. Liang, Y. Kawazeo, W.-T. Geng, High-Throughput Computational Screening of Two-Dimensional Semiconductors, arXiv:1806.04285.
</pre></div>
</div>
<p>Read the CHGCAR from single-point calculation and submit VASP band
structure job.</p>
<p>INCAR example</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>##### initial I/O #####
SYSTEM = MoS2
ICHARG = 11
LWAVE = .TRUE.
LCHARG = .TRUE.
LVTOT = .FALSE.
LVHAR = .FALSE.
LELF = .FALSE.
LORBIT = 11
NEDOS = 1000

##### SCF #####
ENCUT = 500
ISMEAR = 0
SIGMA = 0.05
EDIFF = 1E-6
NELMIN = 5
NELM = 300
GGA = PE
LREAL = .FALSE.
PREC = Accurate
</pre></div>
</div>
</div>
</div>
<div class="section" id="post-process-band-structure-pure-functional">
<h3>3.2 Post-process Band Structure (pure functional)<a class="headerlink" href="#post-process-band-structure-pure-functional" title="Permalink to this headline">¶</a></h3>
<p>After calculation, do band structure post-process by VASPKIT option
<code class="docutils literal notranslate"><span class="pre">21</span></code></p>
<p>Use <code class="docutils literal notranslate"><span class="pre">211</span></code> get the basic band structure. If there are python
environment with matplotlib module. VASPKIT can output a <code class="docutils literal notranslate"><span class="pre">band.png</span></code>
figure automatically. By default, the Fermi energy will be shifted to
the 0 eV.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>211
  --&gt;&gt; (01) Reading Input Parameters From INCAR File...
  --&gt;&gt; (02) Reading Fermi-Energy from DOSCAR File...
 ooooooooo The Fermi Energy will be set to zero eV ooooooooooooooo
  --&gt;&gt; (03) Reading Energy-Levels From EIGENVAL File...
  --&gt;&gt; (04) Reading Structural Parameters from POSCAR File...
  --&gt;&gt; (05) Reading K-Paths From KPOINTS File...
  --&gt;&gt; (06) Written BAND.dat File!
  --&gt;&gt; (07) Written BAND_REFORMATTED.dat File!
  --&gt;&gt; (08) Written KLINES.dat File!
  --&gt;&gt; (09) Written KLABELS File!
  --&gt;&gt; (10) Written BAND_GAP File!
 If you want use the default setting, type 0, if modity type 1
0
/public1/home/pg2059/.local/lib/python2.7/site-packages/matplotlib/font_manager.py:1328: UserWarning: findfont: Font family [u&#39;arial&#39;] not found. Falling back to DejaVu Sans
  (prop.get_family(), self.defaultFamily[fontext]))
  --&gt;&gt; (11) Graph has been generated!
</pre></div>
</div>
<p>Output
<code class="docutils literal notranslate"><span class="pre">BAND.dat</span></code>，<code class="docutils literal notranslate"><span class="pre">BAND_REFORMATTED.dat</span></code>，<code class="docutils literal notranslate"><span class="pre">KLINES.dat</span></code>，<code class="docutils literal notranslate"><span class="pre">KLABELS</span></code>，<code class="docutils literal notranslate"><span class="pre">BAND_GAP</span></code>
files，</p>
<p><code class="docutils literal notranslate"><span class="pre">BAND.dat</span></code>，<code class="docutils literal notranslate"><span class="pre">BAND_REFORMATTED.dat</span></code> files save the band
information, which can be open by ORIGIN directly.</p>
<p><code class="docutils literal notranslate"><span class="pre">BAND_REFORMATTED.dat</span></code>: First column is the length of K-path in unit
of Å-1, and following columns are the energies of energy of each bands.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#K-Path     Energy-Level
  0.000   -14.278   -13.063    -5.798    -2.813    -2.813    -1.962    -1.693    ...
  0.060   -14.268   -13.058    -5.787    -2.836    -2.802    -2.055    -1.710    ...
  0.120   -14.239   -13.044    -5.752    -2.906    -2.769    -2.226    -1.761    ...
  0.180   -14.190   -13.021    -5.695    -3.015    -2.716    -2.416    -1.840    ...
  0.240   -14.123   -12.989    -5.619    -3.157    -2.642    -2.614    -1.943    ...
  0.300   -14.039   -12.948    -5.528    -3.321    -2.817    -2.551    -2.064    ...
  0.360   -13.938   -12.900    -5.428    -3.496    -3.023    -2.443    -2.195    ...
  0.420   -13.823   -12.846    -5.329    -3.671    -3.232    -2.333    -2.322    ...
  0.480   -13.696   -12.786    -5.244    -3.830    -3.441    -2.471    -2.190    ...
  ...
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">KLABELS</span></code> file saves the positions of high symmetry points on band
structure figures:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>K-Label    K-Coordinate in band-structure plots
GAMMA              0.000
M                  1.140
K                  1.798
GAMMA              3.114


* Give the label for each high symmetry point in KPOINTS (KPATH.in) file. Otherwise, they will be identified as &#39;Undefined&#39; in KLABELS file
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">BAND_GAP</span></code> file save the information of band gap, VBM, CBM, and its
locations at reciprocal lattice,</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>+-------------------------- Summary ----------------------------+
         Band Character:    Direct
          Band Gap (eV):    1.6743
 Eigenvalue of VBM (eV):   -0.2257
 Eigenvalue of CBM (eV):    1.4485
      HOMO &amp; LUMO Bands:         9        10
        Location of VBM:  0.333333  0.333333  0.000000
        Location of CBM:  0.333333  0.333333  0.000000
+---------------------------------------------------------------+

NOTE: The VBM and CBM are subtracted by the Fermi Energy.
</pre></div>
</div>
<p>If users have python environment with matplotlib module, VASPKIT can
output a <code class="docutils literal notranslate"><span class="pre">band.png</span></code> figure automatically：</p>
<a class="reference internal image-reference" href="_images/band_MoS2.png"><img alt="_images/band_MoS2.png" class="align-center" src="_images/band_MoS2.png" style="width: 427.7px; height: 313.59999999999997px;" /></a>
<p><strong>212，213，214 get projected band structures</strong>：</p>
<p>Ensure the <code class="docutils literal notranslate"><span class="pre">LORBIT</span> <span class="pre">=</span> <span class="pre">10</span></code> or <code class="docutils literal notranslate"><span class="pre">LORBIT</span> <span class="pre">=</span> <span class="pre">11</span></code> parameter in INCAR to
output projection information.</p>
<p><strong>212) Projected Band-Structure for Selected Atoms</strong>. select projected
atoms:</p>
<p>Input number of selected atoms：<code class="docutils literal notranslate"><span class="pre">1-4</span></code> <code class="docutils literal notranslate"><span class="pre">7</span></code> <code class="docutils literal notranslate"><span class="pre">8</span></code> <code class="docutils literal notranslate"><span class="pre">24</span></code> or
elements：<code class="docutils literal notranslate"><span class="pre">C</span></code> <code class="docutils literal notranslate"><span class="pre">Fe</span></code> <code class="docutils literal notranslate"><span class="pre">H</span></code></p>
<p>For example if you want to draw projected band structure on atom 1 and
2, input <code class="docutils literal notranslate"><span class="pre">1-2</span></code>：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>212
  --&gt;&gt; (01) Reading Input Parameters From INCAR File...
  --&gt;&gt; (02) Reading Fermi-Energy from DOSCAR File...
 ooooooooo The Fermi Energy will be set to zero eV ooooooooooooooo
  --&gt;&gt; (03) Reading Structural Parameters from POSCAR File...
  --&gt;&gt; (04) Reading Energy-Levels From EIGENVAL File...
  --&gt;&gt; (05) Reading Band-Weights From PROCAR File...
  --&gt;&gt; (06) Reading K-Paths From KPOINTS File...
 |---------------------------------------------------------------|
 Input the element-symbol and/or atom-index to SUM [Total-atom: 3]
 (Free Format is OK, e.g., C Fe H 1-4 7 8 24)

 ------------&gt;&gt;
1-2
  --&gt;&gt; (07) Written SELECTED_ATOM_LIST File!
  --&gt;&gt; (08) Written PBAND_A1.dat File!
  --&gt;&gt; (09) Written PBAND_A2.dat File!
  --&gt;&gt; (10) Written KLINES.dat File!
  --&gt;&gt; (11) Written KLABELS File!
</pre></div>
</div>
<p>VASPKIT will output two files: <code class="docutils literal notranslate"><span class="pre">PBAND_A1.dat</span></code> and <code class="docutils literal notranslate"><span class="pre">PBAND_A2.dat</span></code>.</p>
<p>Each file include the projection information on select atoms, and there
weight on each angular momentum,
<code class="docutils literal notranslate"><span class="pre">s</span>&#160;&#160;&#160;&#160; <span class="pre">py</span>&#160;&#160;&#160;&#160; <span class="pre">pz</span>&#160;&#160;&#160;&#160; <span class="pre">px</span>&#160;&#160;&#160; <span class="pre">dxy</span>&#160;&#160;&#160; <span class="pre">dyz</span>&#160;&#160;&#160; <span class="pre">dz2</span>&#160;&#160;&#160; <span class="pre">dxz</span>&#160; <span class="pre">x2-y2</span>&#160;&#160;&#160; <span class="pre">tot</span></code>.
The first column is the length of K-path in unit of Å-1. Second column
is the energy of band. Following column are the projection of
<em>lm</em>-orbitals on this band. Last column is the total projection of
selected atom on this band.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#K-Path    Energy     s     py     pz     px    dxy    dyz    dz2    dxz  x2-y2    tot
#Band-index    1
   0.000   -14.278  0.275  0.000  0.005  0.000  0.000  0.000  0.000  0.000  0.000  0.281
   0.060   -14.268  0.276  0.000  0.005  0.000  0.000  0.000  0.000  0.000  0.000  0.281
   0.120   -14.239  0.276  0.000  0.005  0.000  0.000  0.000  0.000  0.000  0.000  0.281
   0.180   -14.190  0.277  0.000  0.005  0.000  0.000  0.000  0.000  0.000  0.000  0.282
   0.240   -14.123  0.278  0.000  0.005  0.000  0.000  0.000  0.000  0.000  0.000  0.284
   0.300   -14.039  0.280  0.000  0.005  0.001  0.000  0.000  0.000  0.000  0.000  0.285
   0.360   -13.938  0.281  0.000  0.005  0.001  0.000  0.000  0.000  0.000  0.000  0.288
   0.420   -13.823  0.283  0.000  0.005  0.001  0.000  0.000  0.000  0.000  0.000  0.290
   ...
#Band-index    2
   3.114   -13.063  0.315  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.316
   3.045   -13.056  0.315  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.316
   ...
#Band-index    3
   0.000    -5.798  0.018  0.000  0.125  0.000  0.000  0.000  0.000  0.000  0.000  0.143
   0.060    -5.787  0.018  0.000  0.125  0.000  0.000  0.000  0.000  0.000  0.000  0.143
   ...
</pre></div>
</div>
<p><strong>213) Projected Band-Structure for Each Element</strong>，projection on each
elements:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>213
 --&gt;&gt; (1) Reading Input Parameters From INCAR File...
 --&gt;&gt; (2) Reading Fermi-Level From DOSCAR File...
 ooooooooo The Fermi Energy will be set to zero eV ooooooooooooooo
 --&gt;&gt; (3) Reading Structural Parameters from POSCAR File...
 --&gt;&gt; (4) Reading Energy-Levels From EIGENVAL File...
 --&gt;&gt; (5) Reading Band-Weights From PROCAR File...
 --&gt;&gt; (6) Reading K-Paths From KPOINTS File...
 --&gt;&gt; (7) Written PBAND_S.dat File!
 --&gt;&gt; (8) Written PBAND_Mo.dat File!
 --&gt;&gt; (9) Written KLINES.dat File!
 --&gt;&gt; (*) Written KLABELS File!
</pre></div>
</div>
<p>Format of <code class="docutils literal notranslate"><span class="pre">PBAND_S.dat</span></code> and <code class="docutils literal notranslate"><span class="pre">PBAND_Mo.dat</span></code> is same as
<code class="docutils literal notranslate"><span class="pre">PBAND_A1.dat</span></code>. These files can be open by origin:</p>
<a class="reference internal image-reference" href="_images/pband1.png"><img alt="_images/pband1.png" class="align-center" src="_images/pband1.png" style="width: 876.6px; height: 476.4px;" /></a>
<p>Select the first and second line, draw the original band structure
first:</p>
<a class="reference internal image-reference" href="_images/pband2.png"><img alt="_images/pband2.png" class="align-center" src="_images/pband2.png" style="width: 528.6px; height: 422.4px;" /></a>
<p>Then find the position of high symmetry points from <code class="docutils literal notranslate"><span class="pre">KLABELS</span></code>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>GAMMA              0.000
M                  1.139
K                  1.797
GAMMA              3.113
</pre></div>
</div>
<p>Label those points:</p>
<a class="reference internal image-reference" href="_images/pband3.png"><img alt="_images/pband3.png" class="align-center" src="_images/pband3.png" style="width: 511.79999999999995px; height: 349.2px;" /></a>
<a class="reference internal image-reference" href="_images/pband4.png"><img alt="_images/pband4.png" class="align-center" src="_images/pband4.png" style="width: 514.1999999999999px; height: 287.4px;" /></a>
<p>Then, adjust the energy range. The original band structure without
projection information shows as follow.</p>
<a class="reference internal image-reference" href="_images/pband5.png"><img alt="_images/pband5.png" class="align-center" src="_images/pband5.png" style="width: 532.1999999999999px; height: 385.8px;" /></a>
<p>From ORIGIN plot setup tag, add the atoms, elements, or orbitals
projections on band.</p>
<a class="reference internal image-reference" href="_images/pband6.png"><img alt="_images/pband6.png" class="align-center" src="_images/pband6.png" style="width: 276.0px; height: 199.79999999999998px;" /></a>
<p>Select <code class="docutils literal notranslate"><span class="pre">Bubble</span></code> tag, and add the projection. click OK.</p>
<a class="reference internal image-reference" href="_images/pband7.png"><img alt="_images/pband7.png" class="align-center" src="_images/pband7.png" style="width: 441.0px; height: 297.59999999999997px;" /></a>
<a class="reference internal image-reference" href="_images/pband8.png"><img alt="_images/pband8.png" class="align-center" src="_images/pband8.png" style="width: 510.59999999999997px; height: 376.2px;" /></a>
<p><strong>214) The Sum of Projected Band-Structure for Selected Atoms</strong>：</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>214
  --&gt;&gt; (01) Reading Input Parameters From INCAR File...
  --&gt;&gt; (02) Reading Fermi-Energy from DOSCAR File...
 ooooooooo The Fermi Energy will be set to zero eV ooooooooooooooo
  --&gt;&gt; (03) Reading Structural Parameters from POSCAR File...
  --&gt;&gt; (04) Reading Energy-Levels From EIGENVAL File...
  --&gt;&gt; (05) Reading Band-Weights From PROCAR File...
  --&gt;&gt; (06) Reading K-Paths From KPOINTS File...
 |---------------------------------------------------------------|
 Input the element-symbol and/or atom-index to SUM [Total-atom: 3]
 (Free Format is OK, e.g., C Fe H 1-4 7 8 24)

 ------------&gt;&gt;
1-2
  --&gt;&gt; (07) Written SELECTED_ATOM_LIST File!
  --&gt;&gt; (08) Written PBAND_SUM.dat File!
  --&gt;&gt; (09) Written KLINES.dat File!
  --&gt;&gt; (10) Written KLABELS File!
</pre></div>
</div>
<p>The output <code class="docutils literal notranslate"><span class="pre">PBAND_SUM.dat</span></code> file includes the sum projection of
selected atoms or elements. This is useful to investigate the layered
band and compare surface band and inner band.</p>
</div>
<div class="section" id="pre-process-band-structure-hybrid-functional">
<h3>3.3 Pre-process Band Structure (hybrid functional)<a class="headerlink" href="#pre-process-band-structure-hybrid-functional" title="Permalink to this headline">¶</a></h3>
<p>Besides the line-mode K-path, VASPKIT can also generate K-path with
uniformed spacing between K points in units of 2<span class="math notranslate nohighlight">\(\pi\)</span>*Å-1,
which can be used for hybrid functional band structure calculations.
Such KPOINTS file contains two parts. First part is same as the
self-consistent calculation with symmetry weighted K-points in
Irreducilbe Brillouin Zone. And Second part is the 0-weighted K-points
alone the k-path. To generate this KPOINTS file:</p>
<ol class="arabic simple">
<li><p>Same as pure functional calculation. Do geometry optimization. Run
<strong>302</strong> (for 2D materials) or <strong>303</strong> (for 3D materials) to get:</p></li>
</ol>
<ol class="arabic simple">
<li><p>standardized primitive cell (PRIMCELL.vasp)</p></li>
<li><p>line-mode k-path for pure functional band structure calculation
(KPATH.in)</p></li>
<li><p>High-symmetry points in fractional coordinates.
(HIGH_SYMMETRY_POINTS) You can check them with the seekpath database
[<a class="reference external" href="https://www.materialscloud.org/work/tools/seekpath">https://www.materialscloud.org/work/tools/seekpath</a>].</p></li>
</ol>
<ol class="arabic simple" start="2">
<li><p>Run <strong>251</strong> to generate KPOINTS file for hybrid functional
band-structure calculations. Input the KPT resolution values to
determine density of k-mesh for SCF calculation and k-path for band
structure calculation. Then VASPKIT will read KPATH.in file and
generate the KPOINTS file for hybrid functional band-structure
calculation.</p></li>
<li><p><em>Optional</em>. Do a PBE SCF calculations based on the new generated
KPOINTS file and get the wavefunctions, which can be read for next
step hybrid functional calculation. Sometimes, this step reduce the
SCF time of the next step hybrid functional calculation.</p></li>
<li><p>Do hybrid functional band structure calculation.</p></li>
</ol>
<div class="section" id="example-single-layer-mos2-1">
<span id="id1"></span><h4>Example: single layer MoS2<a class="headerlink" href="#example-single-layer-mos2-1" title="Permalink to this headline">¶</a></h4>
<ol class="arabic simple">
<li><p>After optimization. Run <strong>302</strong></p></li>
</ol>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>302
 +-------------------------- Warm Tips --------------------------+
     See An Example in vaspkit/examples/seek_kpath/graphene_2D.
 This feature is still experimental &amp; check the PRIMCELL.vasp file.
 +---------------------------------------------------------------+
 --&gt;&gt; (1) Reading Structural Parameters from POSCAR File...
 +-------------------------- Summary ----------------------------+
           The vacuum slab is supposed to be along c axis
                           Prototype: AB2
           Total Atoms in Input Cell:   3
     Lattice Constants in Input Cell:   3.184   3.184  18.410
        Lattice Angles in Input Cell:  90.000  90.000 120.000
       Total Atoms in Primitive Cell:   3
 Lattice Constants in Primitive Cell:   3.184   3.184  18.410
    Lattice Angles in Primitive Cell:  90.000  90.000 120.000
                  2D Bravais Lattice: Hexagonal
                         Space Group: 187
                         Point Group: 26 [ D3h ]
                       International: P-6m2
                 Symmetry Operations:  12
                    Suggested K-Path: (shown in the next line)
 [ GAMMA-M-K-GAMMA ]
 +---------------------------------------------------------------+
 --&gt;&gt; (2) Written PRIMCELL.vasp file.
 --&gt;&gt; (3) Written KPATH.in File for Band-Structure Calculation.
 --&gt;&gt; (4) Written HIGH_SYMMETRY_POINTS File for Reference.
</pre></div>
</div>
<p>Replace the old POSCAR by the new generated PRIMCELL.vasp:
<code class="docutils literal notranslate"><span class="pre">cp</span> <span class="pre">PRIMCELL.vasp</span> <span class="pre">POSCAR</span></code></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Primitive Cell
  1.000000
    3.18401832481292    0.00000000000000    0.00000000000000
   -1.59200916240646    2.75744075540316    0.00000000000000
    0.00000000000000    0.00000000000000   18.40999984740000
  S   Mo
   2   1
DIRECT
    0.0000000000000000    0.0000000000000000    0.4151505217091287     S1
    0.0000000000000000    0.0000000000000000    0.5848494782908713     S2
    0.6666666666666666    0.3333333333333333    0.5000000000000000    Mo1
</pre></div>
</div>
<p>KPATH.in is line-mode KPOINTS file:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>K-Path Generated by VASPKIT.
   20
Line-Mode
Reciprocal
   0.0000000000   0.0000000000   0.0000000000     GAMMA
   0.5000000000   0.0000000000   0.0000000000     M

   0.5000000000   0.0000000000   0.0000000000     M
   0.3333333333   0.3333333333   0.0000000000     K

   0.3333333333   0.3333333333   0.0000000000     K
   0.0000000000   0.0000000000   0.0000000000     GAMMA
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Run <strong>251</strong> to generate KPOINTS file for hybrid functional
band-structure calculations. Select (1) Monkhorst-Pack Scheme or (2)
Gamma Scheme to generate k-mesh for SCF calculation.</p></li>
</ol>
<p>Then input the resolution value of normal weighted K-Mesh and 0-weighted
K-path, respectively. VASPKIT will write a new KPOINTS according to
users’ input.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>251
 --&gt;&gt; (1) Reading Structural Parameters from POSCAR File...
 ======================= K-Mesh Scheme ==========================
 1) Monkhorst-Pack Scheme
 2) Gamma Scheme

 0)   Quit
 9)   Back
 -------------&gt;&gt;
2
 +-------------------------- Warm Tips --------------------------+
 Input Resolution Value to Determine K-Mesh for SCF Calculation:
 (Typical Value: 0.03-0.04 is Generally Precise Enough)
 ------------&gt;&gt;
0.05
 Input Resolution Value along K-Path for Band Calculation:
 (Typical Value: 0.02-0.04 for DFT and 0.04-0.06 for hybrid DFT)
 ------------&gt;&gt;
0.05
 +---------------------------------------------------------------+
 --&gt;&gt; (2) Reading K-Paths From KPATH.in File...
 +-------------------------- Summary ----------------------------+
 K-Mesh for SCF Calculation:    7    7    1
 The Number of K-Point along K-Path 1:  22
 The Number of K-Point along K-Path 2:  13
 The Number of K-Point along K-Path 3:  26
 +---------------------------------------------------------------+
 --&gt;&gt; (3) Written KPOINTS File!
</pre></div>
</div>
<p>Here, the resolution value of normal weighted K-Mesh and 0-weighted
K-path is set to be 0.05. Output K-mesh for SCF Calculation: 7 7 1. And
the number of k-points along each line of k-path: <span class="math notranslate nohighlight">\(\Gamma\)</span>-&gt; M :
22, M -&gt; K : 13, K -&gt; <span class="math notranslate nohighlight">\(\Gamma\)</span> : 26. The KPOINTS file:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Parameters to Generate KPOINTS (Don&#39;t Edit This Line):   0.050  0.050    8   61   3  22  13  26
    69
Reciprocal lattice
    0.00000000000000    0.00000000000000    0.00000000000000     1
    0.14285714285714    0.00000000000000    0.00000000000000     6
    0.28571428571429    0.00000000000000    0.00000000000000     6
    0.42857142857143    0.00000000000000    0.00000000000000     6
    0.14285714285714    0.14285714285714    0.00000000000000     6
    0.28571428571429    0.14285714285714    0.00000000000000    12
    0.42857142857143    0.14285714285714    0.00000000000000     6
    0.28571428571429    0.28571428571429    0.00000000000000     6
    0.00000000000000    0.00000000000000    0.00000000000000     0
    0.02380952380952    0.00000000000000    0.00000000000000     0
   ...
   ...
   ...
    0.02666666666400    0.02666666666400    0.00000000000000     0
    0.01333333333200    0.01333333333200    0.00000000000000     0
    0.00000000000000    0.00000000000000    0.00000000000000     0
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Do PBE calculation. Can be skip.</p></li>
<li><p>Do hybird functional band structure calculation. The detail of INCAR
parameters are discussed in
<a class="reference external" href="http://blog.wangruixing.cn/2019/05/20/hse/">http://blog.wangruixing.cn/2019/05/20/hse/</a> , INCAR:</p></li>
</ol>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>##### initial I/O #####
SYSTEM = Hybird Functional
ISTART = 1
ICHARG = 1
LWAVE = .TRUE.
LCHARG = .TRUE.
LVTOT = .FALSE.
LVHAR = .FALSE.
LELF = .FALSE.
LORBIT = 11
NEDOS = 1000

##### SCF #####
ENCUT = 500
ISMEAR = 0
SIGMA = 0.05
EDIFF = 1E-6
NELMIN = 5
NELM = 300
GGA = PE
LREAL = .FALSE.
# PREC = Accurate
# ISYM = 3

##### Geo opt #####
EDIFFG = -0.01
IBRION = 2
POTIM = 0.2
NSW = 0 # no Geo_opt
ISIF = 3  # 2 not optimize cell

#### HSE ####
LHFCALC = .TRUE.
AEXX   =  0.25
HFSCREEN = 0.2
ALGO = ALL # or Damped
TIME   =  0.4
</pre></div>
</div>
</div>
</div>
<div class="section" id="post-process-band-structure-hybrid-functional">
<h3>3.4 Post-process Band Structure (hybrid functional)<a class="headerlink" href="#post-process-band-structure-hybrid-functional" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple" start="5">
<li><p>Extract band structure information by <strong>252</strong>. band data is saved in
<code class="docutils literal notranslate"><span class="pre">BAND.dat</span></code> and <code class="docutils literal notranslate"><span class="pre">BAND-REFORMATTED.dat</span></code> files. High-symmetry
points positions on band structure figures are saved in <code class="docutils literal notranslate"><span class="pre">KLABELS</span></code>.</p></li>
</ol>
<p>(Note: bug in 0.73 version, please use new version)</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>252
  --&gt;&gt; (01) Reading Input Parameters From INCAR File...
  --&gt;&gt; (02) Reading Fermi-Energy from DOSCAR File...
 ooooooooo The Fermi Energy will be set to zero eV ooooooooooooooo
  --&gt;&gt; (03) Reading Energy-Levels From EIGENVAL File...
  --&gt;&gt; (04) Reading Structural Parameters from POSCAR File...
  --&gt;&gt; (05) Reading K-Paths From KPATH.in File...
  --&gt;&gt; (06) Written BAND.dat File!
  --&gt;&gt; (07) Written BAND_REFORMATTED.dat File!
  --&gt;&gt; (08) Written KLINES.dat File!
  --&gt;&gt; (09) Written KLABELS File!
  --&gt;&gt; (10) Written BAND_GAP File!
 If you want use the default setting, type 0, if modity type 1
0
  --&gt;&gt; (11) Graph has been generated!
</pre></div>
</div>
<p>if the python and matplotlib enviornment is set correctly. VASPKIT will
draw a band figure <code class="docutils literal notranslate"><span class="pre">band.png</span></code> automatically. Following parameters
should be set in <code class="docutils literal notranslate"><span class="pre">~/.vaspkit</span></code> file.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>PYTHON_BIN           ~/anaconda3/bin/python3
PLOT_MATPLOTLIB          .TURE.
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/hse-band1.png"><img alt="_images/hse-band1.png" class="align-center" src="_images/hse-band1.png" style="width: 720.0px; height: 540.0px;" /></a>
<p>You can also draw the figure from <code class="docutils literal notranslate"><span class="pre">BAND.dat</span></code> or
<code class="docutils literal notranslate"><span class="pre">BAND_REFORMATTED.dat</span></code> by ORIGIN, which is described in Section 3.2.</p>
<p>By comparing with the line-mode of KPOINTS (option <code class="docutils literal notranslate"><span class="pre">302</span></code> and <code class="docutils literal notranslate"><span class="pre">303</span></code>).
The biggest advantages of <code class="docutils literal notranslate"><span class="pre">25</span></code> is that the k spacing along K-path is
averaged, so that saves computational cost.</p>
<p>Versions prior to 0.72 took the same number of K-points for energy line,
resulting in uneven K-distribution on different paths, as shown in the
lift figure below. The latest version of VASPKIT supports automatic
determination of K-points number on different energy band paths based on
a given k-point interval, thus ensuring uniform spattering throughout
the band calculation, as shown in right Figure below.</p>
<p>KPOINTS generated from vaspkit <code class="docutils literal notranslate"><span class="pre">251</span></code> keeps the spacing between every k
points. So, one can use less 0-weighted k points to get a similar
qualified band structure, and thus, take less time when doing band
structure calculations.</p>
<a class="reference internal image-reference" href="_images/hse-band2.png"><img alt="_images/hse-band2.png" class="align-center" src="_images/hse-band2.png" style="width: 707.4px; height: 451.2px;" /></a>
<p><strong>To get projected hybrid functional band structure, please use
253，254，255</strong>：</p>
<p>Ensure the <code class="docutils literal notranslate"><span class="pre">LORBIT</span> <span class="pre">=</span> <span class="pre">10</span></code> or <code class="docutils literal notranslate"><span class="pre">LORBIT</span> <span class="pre">=</span> <span class="pre">11</span></code> parameter in INCAR to
output projection information.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>253) Get Projected Band-Structure for Selected Atoms
254) Get Projected Band-Structure for Each ELement
255) Get the Sum of Projected Band-Structure for Selected Atoms
</pre></div>
</div>
<p>For example: by using <strong>253</strong>, a free format input is available. You can
input any atoms by its index and any elements symbol. Projected band
structure will saved for each elements one by one.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>  --&gt;&gt; (01) Reading Input Parameters From INCAR File...
  --&gt;&gt; (02) Reading Fermi-Energy from DOSCAR File...
 ooooooooo The Fermi Energy will be set to zero eV ooooooooooooooo
  --&gt;&gt; (03) Reading Structural Parameters from POSCAR File...
  --&gt;&gt; (04) Reading Energy-Levels From EIGENVAL File...
  --&gt;&gt; (05) Reading Band-Weights From PROCAR File...
  --&gt;&gt; (06) Reading K-Paths From KPATH.in File...
 |---------------------------------------------------------------|
 Input the element-symbol and/or atom-index to SUM [Total-atom: 3]
 (Free Format is OK, e.g., C Fe H 1-4 7 8 24)

 ------------&gt;&gt;
1-3
  --&gt;&gt; (07) Written SELECTED_ATOM_LIST File!
  --&gt;&gt; (08) Written PBAND_A1.dat File!
  --&gt;&gt; (09) Written PBAND_A2.dat File!
  --&gt;&gt; (10) Written PBAND_A3.dat File!
  --&gt;&gt; (11) Written KLINES.dat File!
  --&gt;&gt; (12) Written KLABELS File!
</pre></div>
</div>
<p>Elements projected band structure obtained by using <strong>254</strong>,</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>254
  --&gt;&gt; (01) Reading Input Parameters From INCAR File...
  --&gt;&gt; (02) Reading Fermi-Energy from DOSCAR File...
 ooooooooo The Fermi Energy will be set to zero eV ooooooooooooooo
  --&gt;&gt; (03) Reading Structural Parameters from POSCAR File...
  --&gt;&gt; (04) Reading Energy-Levels From EIGENVAL File...
  --&gt;&gt; (05) Reading Band-Weights From PROCAR File...
  --&gt;&gt; (06) Reading K-Paths From KPATH.in File...
  --&gt;&gt; (07) Written PBAND_S.dat File!
  --&gt;&gt; (08) Written PBAND_Mo.dat File!
  --&gt;&gt; (09) Written KLINES.dat File!
  --&gt;&gt; (10) Written KLABELS File!
</pre></div>
</div>
<p>All your input atoms will be sumed up and are projected to the band
structure by using <strong>255</strong>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>255

  --&gt;&gt; (01) Reading Input Parameters From INCAR File...
  --&gt;&gt; (02) Reading Fermi-Energy from DOSCAR File...
 ooooooooo The Fermi Energy will be set to zero eV ooooooooooooooo
  --&gt;&gt; (03) Reading Structural Parameters from POSCAR File...
  --&gt;&gt; (04) Reading Energy-Levels From EIGENVAL File...
  --&gt;&gt; (05) Reading Band-Weights From PROCAR File...
  --&gt;&gt; (06) Reading K-Paths From KPATH.in File...
 |---------------------------------------------------------------|
 Input the element-symbol and/or atom-index to SUM [Total-atom: 3]
 (Free Format is OK, e.g., C Fe H 1-4 7 8 24)

 ------------&gt;&gt;
1-2
  --&gt;&gt; (07) Written SELECTED_ATOM_LIST File!
  --&gt;&gt; (08) Written PBAND_SUM.dat File!
  --&gt;&gt; (09) Written KLINES.dat File!
  --&gt;&gt; (10) Written KLABELS File!
</pre></div>
</div>
<p><strong>supplementary</strong>: band structure can also be down by pymatgen package:</p>
<a class="reference internal image-reference" href="_images/hse-band3.png"><img alt="_images/hse-band3.png" class="align-center" src="_images/hse-band3.png" style="width: 660.0px; height: 510.0px;" /></a>
</div>
<div class="section" id="effective-mass">
<h3>3.5 Effective Mass<a class="headerlink" href="#effective-mass" title="Permalink to this headline">¶</a></h3>
<p>For electrons or holes in a solid, the effective mass (<em>m</em>*) is a
quantity that is used to simplify band structures by modeling the
behavior of a free particle with that mass. At the highest energies of
the valence band in semiconductors (Ge, Si, GaAs, …), and the lowest
energies of the conduction band in semiconductors (GaAs, …), the band
structure <em>E</em>(<strong>k</strong>) can be locally approximated as:</p>
<div class="math notranslate nohighlight">
\[E(\mathbf{k})=E_{0}+\frac{\hbar^{2} \mathbf{k}^{2}}{2 m^{*}}\]</div>
<p>where <em>E</em>(<strong>k</strong>) is the energy of an electron at wavevector <strong>k</strong> in
that band, <em>E</em>0 is a constant giving the edge of energy of that band.
So <em>m</em>* can be calculated by following equation:</p>
<div class="math notranslate nohighlight">
\[\frac{1}{m^{*}}=\frac{1}{\hbar^{2}} \frac{\partial^{2} E}{\partial k_{i} \partial k_{j}}\]</div>
<p>Usually, we are interested in the <em>m</em>* from one high symmetry point
to another high symmetry point. So the direction of <span class="math notranslate nohighlight">\(k_{i}\)</span> and
<span class="math notranslate nohighlight">\(k_{j}\)</span> are same, such as K -&gt; M, K -&gt; <span class="math notranslate nohighlight">\(\Gamma\)</span>. To get the
second-order partial derivative, KPOINTS file should include K points
very near to that high symmetry point. VASPKIT can generate KPOINTS file
for VASP calculation and get the effective mass automatically. (Note:
Now, VASPKIT only support effective mass calculation for Non-Charged &amp;
Non-Magnetic Semiconductor!)</p>
<a class="reference internal image-reference" href="_images/emc.png"><img alt="_images/emc.png" class="align-center" src="_images/emc.png" style="width: 476.6px; height: 431.6px;" /></a>
<div class="section" id="example-single-layer-mos2-effective-mass">
<h4>Example: Single Layer MoS2 effective mass<a class="headerlink" href="#example-single-layer-mos2-effective-mass" title="Permalink to this headline">¶</a></h4>
<ol class="arabic simple">
<li><p>Find out the band edges by band structure calculation. The VBM is at
K, and the CBM is also at K.</p></li>
<li><p>Select the direction to do second-order derivative. Here, we select
K -&gt; M, K -&gt; <span class="math notranslate nohighlight">\(\Gamma\)</span> to calculate their electron and hole
effective mass.</p></li>
<li><p>Prepare POSCAR and VPKIT.in:</p></li>
</ol>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>1       # &quot;1&quot; for pre-process (generate KPOINTS), &quot;2&quot; for post-process(calculate m*)
6       # number of points for quadratic function fitting.
0.015   # k-cutoff, unit Å-1.
2       # number of tasks for effective mass calculation
0.333333 0.3333333 0.000 0.000 0.000 0.000 K-&gt;Γ # Specified two K-points and direction
0.333333 0.3333333 0.000 0.500 0.000 0.000 K-&gt;M # Specified two K-points and direction
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li><p>Run VASPKIT <code class="docutils literal notranslate"><span class="pre">912</span></code>, and input the parameters for K-Mesh Scheme, and
VASPKIT will generate a KPOINTS file based on the VPKIT.in file with
0-weight K-points.</p></li>
</ol>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> +-------------------------- Warm Tips --------------------------+
      Test ONLY for Non-Charged &amp; Non-Magnetic Semiconductor!
 +---------------------------------------------------------------+
  --&gt;&gt; (01) Reading VPKIT.in File...
  --&gt;&gt; (02) Reading Structural Parameters from POSCAR File...
 ======================= K-Mesh Scheme ==========================
 1) Monkhorst-Pack Scheme
 2) Gamma Scheme

 0)   Quit
 9)   Back
 -------------&gt;&gt;
2
 +-------------------------- Warm Tips --------------------------+

- Accuracy Levels: Gamma-Only: 0;
   Low: 0.06~0.04;
   Medium: 0.04~0.03;
   Fine: 0.02-0.01.
- 0.03-0.04 is Generally Precise Enough!
  +---------------------------------------------------------------+
   Input KPT-Resolved Value (e.g., 0.04, in unit of 2*PI/Angstrom):
   ------------&gt;&gt;
  0.04
       1
    --&gt;&gt; (03) Written KPOINTS File!
    --&gt;&gt; (04) Written INCAR file!
    --&gt;&gt; (05) Written POTCAR File with the Standard Potential!
</pre></div>
</div>
<p>The generate the KPOINTS is:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Parameters to Generate KPOINTS (Don&#39;t Edit This Line):     0.0400    12     2     6
    24
Reciprocal lattice
    0.00000000000000    0.00000000000000    0.00000000000000     1
    0.11111111111111    0.00000000000000    0.00000000000000     6
    0.22222222222222    0.00000000000000    0.00000000000000     6
    0.33333333333333    0.00000000000000    0.00000000000000     6
    0.44444444444444    0.00000000000000    0.00000000000000     6
    0.11111111111111    0.11111111111111    0.00000000000000     6
    0.22222222222222    0.11111111111111    0.00000000000000    12
    0.33333333333333    0.11111111111111    0.00000000000000    12
    0.44444444444444    0.11111111111111    0.00000000000000     6
    0.22222222222222    0.22222222222222    0.00000000000000     6
    0.33333333333333    0.22222222222222    0.00000000000000    12
    0.33333333333333    0.33333333333333    0.00000000000000     2
    0.33333300000000    0.33333330000000    0.00000000000000     0 # K-&gt;Γ
    0.32795808307727    0.33136593967371    0.00000000000000     0
    0.32258316615454    0.32939857934742    0.00000000000000     0
    0.31720824923180    0.32743121902113    0.00000000000000     0
    0.31183333230907    0.32546385869484    0.00000000000000     0
    0.30645841538634    0.32349649836855    0.00000000000000     0
    0.33333300000000    0.33333330000000    0.00000000000000     0 # K-&gt;M
    0.33673240318272    0.32574567174541    0.00000000000000     0
    0.34013180636544    0.31815804349082    0.00000000000000     0
    0.34353120954815    0.31057041523622    0.00000000000000     0
    0.34693061273087    0.30298278698163    0.00000000000000     0
    0.35033001591359    0.29539515872704    0.00000000000000     0
</pre></div>
</div>
<ol class="arabic simple" start="5">
<li><p>Submit VASP job.</p></li>
<li><p>Replace the first line of VPKIT.in by <code class="docutils literal notranslate"><span class="pre">2</span></code>. Then re-run VASPKIT
<code class="docutils literal notranslate"><span class="pre">913</span></code> to get the effective mass of electron and hole.</p></li>
</ol>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>913
 +-------------------------- Warm Tips --------------------------+
      Test ONLY for Non-Charged &amp; Non-Magnetic Semiconductor!
 +---------------------------------------------------------------+
  --&gt;&gt; (01) Reading VPKIT.in File...
  --&gt;&gt; (02) Reading Structural Parameters from POSCAR File...
  --&gt;&gt; (03) Reading Input Parameters From INCAR File...
  --&gt;&gt; (04) Reading Energy-Levels From EIGENVAL File...
 +-------------------------- Summary ----------------------------+
 Effective-Mass is obtained by fitting a third order polynomial,
 which yields masses are less sensitive to the employed k-points.
 Band Index:                LUMO =   10               HOMO =   9
 Effective-Mass (in m0)     Electron (Prec.)          Hole (Prec.)
 K-Path Index 1: K-&gt;Γ        0.480 (0.2E-07)      -0.577 (0.2E-07)
 K-Path Index 2: K-&gt;M        0.527 (0.8E-07)      -0.705 (0.2E-06)
 +---------------------------------------------------------------+
</pre></div>
</div>
<p>Kormányos et al. calculated the effective masses of electron and hole
carriers for the MoS2 monolayers to be 0.44 and 0.54, respectively [see
2D Mater. 2 (2015) 049501]. Note: If the valence band and the conduction
band bottom are degenerate, such as GaAs and GaN, it will be difficult
to guarantee accuracy at this time.</p>
</div>
</div>
<div class="section" id="band-unfolding">
<h3>3.6 Band-unfolding<a class="headerlink" href="#band-unfolding" title="Permalink to this headline">¶</a></h3>
<p>The electronic structures of real materials are perturbed by various
structural defects, impurities, fl?uctuations of the chemical composition
in compound alloys and so on. In DFT calcualtions, these defects and
incommensurate structures are usually investigated by using supercell
(SC) models. However, interpretation of <span class="math notranslate nohighlight">\(E(\vec{k})\)</span> versus <span class="math notranslate nohighlight">\(\vec{k}\)</span>
band structures is most effective within the primitive cell (PC).
Popescu and Zunger [see PRL 104, 236403 (2010) and PRB 85, 085201
(2012)] proposed the effective band structures (EBS) method which can
unfold the band structures of supercells into the Brillouin zone (BZ) of
the correspoind primitive cell. Such band unfolding techniques greatly
simplify the analysis of the results and enabling direct comparisons
with experimental measurements, for example, angle-resolved
photoemission spectroscopy (ARPES), often represented along the
high-symmetry directions of the primtive cell BZ.</p>
<p>Next we will build a rectangle-like MoS<span class="math notranslate nohighlight">\(_2\)</span> supercell with
single sulfur vacancy and perfom band unfolding calcualtion using VASP
together with VASPKIT codes.</p>
<a class="reference internal image-reference" href="_images/ebs_MoS2.png"><img alt="_images/ebs_MoS2.png" class="align-center" src="_images/ebs_MoS2.png" style="width: 921.0px; height: 381.5px;" /></a>
<p><strong>First step: Prepare the following files;</strong></p>
<ol class="arabic">
<li><p>POSCAR for monolayer MoS<span class="math notranslate nohighlight">\(_2\)</span></p>
<p>primitive cell</p>
</li>
</ol>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>MoS2-H.POSCAR
   1.00000000000000000
     3.1904063769892548    0.0000000000000000    0.0000000000000000
    -1.5952031884946274    2.7629729709066906    0.0000000000000000
     0.0000000000000000    0.0000000000000000   17.6585355706663840
   Mo   S
     1     2
Direct
  0.3333333429999996  0.6666666870000029  0.5000000000000000
  0.6666666870000029  0.3333333429999996  0.4117002781430051
  0.6666666870000029  0.3333333429999996  0.5882996918569924
</pre></div>
</div>
<ol class="arabic" start="2">
<li><p>KPATH.in file for MoS<span class="math notranslate nohighlight">\(_2\)</span></p>
<p>primitive cell (not for supercell), you can genenate it by run
vaspkit with task 302 for 2D or 303 for bulk, or edit it manually. We
choose the K-Path of M-K-<span class="math notranslate nohighlight">\(\Gamma\)</span> for monolayer MoS2.</p>
</li>
</ol>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>KPATH for MoS2
20
Line mode
Rec
  0.00000000000 0.50000000000 0.00000000000 # M
  0.33333333333 0.33333333333 0.00000000000 # K

  0.33333333333 0.33333333333 0.00000000000 # K
  0.00000000000 0.00000000000 0.00000000000 # GAMMA
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>INCAR file for static calculation，set LWAVE =.TRUE.. To aviod the
error ’ERROR! Computed NPLANE= **** != input NPLANE= ****’, please
set PREC=N or a medium/lower value of energy cuttoff.</p></li>
</ol>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>SYSTEM = MoS2
ISTART = 1
LREAL = F
PREC = N
LWAVE = .TRUE.
LCHARG = F
ISMEAR = 0
SIGMA = 0.05
NELM = 60
NELMIN = 6
EDIFF = 1E-08
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li><p>TRANSMAT.in file (optional). The content of this file is</p></li>
</ol>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Read transformation matrix from the TRANSMAT.in file if it exists.
  2  0  0   # must be three integers
  0  3  0   # must be three integers
  0  0  3   # must be three integers
</pre></div>
</div>
<p>where the first line is the comment line, and the integers from second
line to four lines are the elements of 3$:raw-latex:<cite>times`$3 the
transmission matrix :math:`M</cite>, the relationship of lattice vectors
between supercell <span class="math notranslate nohighlight">\(E(\vec{A})\)</span> satisfies <span class="math notranslate nohighlight">\(E(\vec{a})\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{split}\left(\begin{array}{l}{\vec{A}_{1}} \\ {\vec{A}_{2}} \\ {\vec{A}_{3}}\end{array}\right)=
M
 \cdot\left(\begin{array}{l}{\vec{a}_{1}} \\ {\vec{a}_{2}} \\ {\vec{a}_{3}}\end{array}\right)=\left(\begin{array}{lll}{m_{11}} &amp; {m_{12}} &amp; {m_{13}} \\ {m_{21}} &amp; {m_{22}} &amp; {m_{23}} \\ {m_{31}} &amp; {m_{32}} &amp; {m_{33}}\end{array}\right) \cdot\left(\begin{array}{l}{\vec{a}_{1}} \\ {\vec{a}_{2}} \\ {\vec{a}_{3}}\end{array}\right)\end{split}\]</div>
<p>If the off-diagonal elements in <span class="math notranslate nohighlight">\(M\)</span> are zero, the lattice vectors
of supercell will be parallel to those of primtivel cell.</p>
<p><strong>Second step: Run vapskit with task 400 to generate SUPERCELL.vasp and
TRANSMAT (if TRANSMAT.in not exist). We modify the SUPERCELL.vasp file
by removing a sulfur atom to creat signle S vacancy
(V:math:`_text{S}`) point defect;</strong></p>
<p>The primitive cell of MoS<span class="math notranslate nohighlight">\(_2\)</span> monolayer belongs to hexagonal
crystal system. We can build a rectangle-supercell by using vaspkit with
task 400. If the TRANSMAT.in file does not exist, vaspkit will read the
9 elements of <span class="math notranslate nohighlight">\(M\)</span> by dialogue menu (see the following commands).
Otherwise, the elements of <span class="math notranslate nohighlight">\(M\)</span> will be read from the TRANSMAT.in
file.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>vaspkit -task 400
 +---------------------------------------------------------------+
 |           VASPKIT Version: 1.00.RC (17 Jun. 2019)             |
 |       A Pre- and Post-Processing Program for VASP Code        |
 |            Running VASPKIT Under Command-Line Mode            |
 +---------------------------------------------------------------+
  --&gt;&gt; (01) Reading Structural Parameters from POSCAR File...
 Enter the new lattice verctor a in terms of old:
 (MUST be three integers, e.g., 1 2 3)
   4   0   0
 Enter the new lattice verctor b in terms of old:
   2   4   0
 Enter the new lattice verctor c in terms of old:
   0   0   1
 +-------------------------- Summary ----------------------------+
 The Transformation Matrix P is:
   4   0   0
   2   4   0
   0   0   1
 Lattice Constants in New Cell:  12.762  11.052  17.659
 Lattice Angles in New Cell:   90.00   90.00   90.00
 Total Atoms in New Cell:  48
 Volume of New Cell is 16 times of the Old Cell
 +---------------------------------------------------------------+
  --&gt;&gt; (02) Written SUPERCELL.vasp File
</pre></div>
</div>
<p><strong>Third step: cp SUPERCELL.vasp POSCAR and cp TRANSMAT TRANSMAT.in (if
TRANSMAT.in not exist) and run vaspkit with task 281 to generate KPOINTS
file;</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> ------------&gt;&gt;
28
 +-------------------------- Warm Tips --------------------------+
       See some examples in vaspkit/examples/band_unfolding.
          Only Support KPOINTS file Generated by VASPKIT.
            Please Set LWAVE= .TRUE. in the INCAR file.
 +---------------------------------------------------------------+
 ================== Band-Unfolding ==============================
 281) Generate KPOINTS File for Band-Unfolding Calculation
 282) Calculate Effective Band Structure

 0)   Quit
 9)   Back
 ------------&gt;&gt;
281

  --&gt;&gt; (01) Reading Structural Parameters from POSCAR File...
 +---------------------------------------------------------------+
 |               Selective Dynamics is Activated!                |
 +---------------------------------------------------------------+
 ======================= K-Mesh Scheme ==========================
 1) Monkhorst-Pack Scheme
 2) Gamma Scheme

 0)   Quit
 9)   Back
 -------------&gt;&gt;
2
 +-------------------------- Warm Tips --------------------------+
 Input Resolution Value to Determine K-Mesh for SCF Calculation:
 (Typical Value: 0.02-0.03 is Generally Precise Enough)
 ------------&gt;&gt;
0.03
 Input Resolution Value along K-Path for Band Calculation:
 (Typical Value: 0.02-0.04 for DFT and 0.04-0.06 for hybrid DFT)
 ------------&gt;&gt;
0.03
 +---------------------------------------------------------------+
  --&gt;&gt; (02) Readin Transformation Matrix from TRANSMAT.in file...
  --&gt;&gt; (03) Reading K-Paths From KPATH.in File...
 +-------------------------- Summary ----------------------------+
 K-Mesh for SCF Calculation:    3    3    1    # Based on SC reciprocal lattice length
 The Number of K-Point along K-Path 1:  21     # Based on PC reciprocal lattice length
 The Number of K-Point along K-Path 2:  43     # Based on PC reciprocal lattice length
 +---------------------------------------------------------------+
</pre></div>
</div>
<p><strong>Forth step: Submit vasp job；</strong></p>
<p><strong>Fifth step: Run vaspkit with task 282 to get EBS；</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> ------------&gt;&gt;
282
 +-------------------------- Warm Tips --------------------------+
   Current Version Only Support the Stardard Version of VASP code.
 +---------------------------------------------------------------+
  --&gt;&gt; (01) Reading the header information in WAVECAR file...
 +--------------------- WAVECAR Header --------------------------+
 SPIN =    1
 NKPTS =   68
 NBANDS = 252
 ENCUT =   280.00
 Coefficients Precision: Complex*8
 Maximum number of G values: GX =   18, GY =   16, GZ =   25
 Estimated maximum number of plane-waves:   30159
 +---------------------------------------------------------------+
  --&gt;&gt; (02) Start to read WAVECAR file, take your time ^.^
            Percentage complete:  25.0%
            Percentage complete:  50.0%
            Percentage complete:  75.0%
            Percentage complete: 100.0%
  --&gt;&gt; (03) Readin Transformation Matrix from TRANSMAT.in file...
  --&gt;&gt; (04) Reading Fermi-Energy from DOSCAR File...
 ooooooooo The Fermi Energy will be set to zero eV ooooooooooooooo
  --&gt;&gt; (05) Reading KPOINTS_MAPPING_TABLE.in file...
  --&gt;&gt; (06) Reading K-Paths From KPATH.in File...
  --&gt;&gt; (07) Start to Calculate Effective Band Structure...
            Percentage complete:  25.0%
            Percentage complete:  50.0%
            Percentage complete:  75.0%
            Percentage complete: 100.0%
  --&gt;&gt; (08) Written EBS.dat File!
  --&gt;&gt; (09) Written KLABELS File!
</pre></div>
</div>
<p><strong>Last step: You can use vaspkit/examples/band_unfolding/eps_plot.py or
other scripts to plot.</strong></p>
</div>
<div class="section" id="d-band-structure">
<h3>3.7 3D Band Structure<a class="headerlink" href="#d-band-structure" title="Permalink to this headline">¶</a></h3>
<p>In solid-state physics, the most usual electronic <em>band structure</em> (or
simply <em>band structure</em>) is 2D band structure, which shows the energy
change along the K-path line.</p>
<p>VASPKIT can also do 3D band structure, which select K-path on a surface
of Irreducilbe Brillouin zone. And calculate the K-dependent band
energies on those K-points. This method is often used to 2D materials,
such as graphene.</p>
<div class="section" id="example-graphene-3d-band-structure">
<h4>Example: Graphene 3D Band Structure<a class="headerlink" href="#example-graphene-3d-band-structure" title="Permalink to this headline">¶</a></h4>
<ol class="arabic simple">
<li><p>Prepare graphene POSCAR and INCAR files for SCF calculation as
descript in <a class="reference external" href="###%203.1%20Pre-process%20Band%20Structure%20(pure%20functional)">Section
3.1</a></p></li>
<li><p>Run VASPKIT and select <code class="docutils literal notranslate"><span class="pre">231</span></code> to generate a KPOINTS file for 3D
band calculation. The execution interface is as follows. The
generated KPOINTS contains 1-weighted KPOINTS and 0-weight KPOINTS
(Note that in order to obtain a smooth 3D energy band, the
resolution value used to generate the KPOINTS file should be set at
around 0.01)</p></li>
</ol>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>231

 +-------------------------- Warm Tips --------------------------+
   * Accuracy Levels: (1) Low:    0.04~0.03;
                      (2) Medium: 0.03~0.02;
                      (3) Fine:   0.02~0.01.
   * 0.015 is Generally Precise Enough!
 +---------------------------------------------------------------+
 Input KP-Resolved Value (unit: 2*PI/Ang):
 ------------&gt;&gt;
0.015

  --&gt;&gt; (01) Reading Structural Parameters from POSCAR File...
  --&gt;&gt; (02) Written KPOINTS File!
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Submit VASP job.</p></li>
<li><p>After the VASP calculation is complete, run VASPKIT again and enter
the <code class="docutils literal notranslate"><span class="pre">232</span></code> or <code class="docutils literal notranslate"><span class="pre">233</span></code> command. The <code class="docutils literal notranslate"><span class="pre">233</span></code> command can output the
VBM band and CBM band to BAND.HOMO.grd and BAND.LUMO.grd. <code class="docutils literal notranslate"><span class="pre">232</span></code>
can get the calculation data of any other band. Here we choose
<code class="docutils literal notranslate"><span class="pre">233</span></code>:</p></li>
</ol>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>------------&gt;&gt;
233
 +-------------------------- Warm Tips --------------------------+
           ONLY Reliable for Band-Structure Calculations!
 +---------------------------------------------------------------+
 --&gt;&gt; (1) Reading Input Parameters From INCAR File...
 --&gt;&gt; (2) Reading Structural Parameters from POSCAR File...
 --&gt;&gt; (3) Reading Fermi-Level From DOSCAR File...
ooooooooo The Fermi Energy will be set to zero eV oooooooooooooooo
 --&gt;&gt; (4) Reading Energy-Levels From EIGENVAL File...
 --&gt;&gt; (5) Reading Kmesh From KPOINTS File...
 --&gt;&gt; (6) Written BAND.HOMO.grd File.
 --&gt;&gt; (7) Written BAND.LUMO.grd File.
 --&gt;&gt; (8) Written KX.grd and KY.grd Files.
</pre></div>
</div>
<ol class="arabic simple" start="5">
<li><p>run <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">VASPKITdir/examples/3D_band/how_to_visual.py</span></code> to get
the 3D band structure.</p></li>
</ol>
<a class="reference internal image-reference" href="_images/3d_graphene.png"><img alt="_images/3d_graphene.png" class="align-center" src="_images/3d_graphene.png" style="width: 720.0px; height: 540.0px;" /></a>
</div>
</div>
<div class="section" id="fermi-surface">
<h3>3.8 Fermi Surface<a class="headerlink" href="#fermi-surface" title="Permalink to this headline">¶</a></h3>
<p>In condensed matter physics, the <strong>Fermi surface</strong> is the <strong>surface</strong> in
reciprocal space which separates occupied bands from unoccupied bands at
zero temperature. The shape of the <strong>Fermi surface</strong> is derived from the
periodicity and symmetry of the crystalline lattice and from the
occupation of electronic energy bands.</p>
<div class="section" id="example-cu-fermi-surface">
<h4>Example: Cu Fermi Surface<a class="headerlink" href="#example-cu-fermi-surface" title="Permalink to this headline">¶</a></h4>
<ol class="arabic simple">
<li><p>prepare the optimized POSCAR of FCC Cu. Note that it must be the
primitive cell.</p></li>
<li><p>Run VASPKIT and enter the <code class="docutils literal notranslate"><span class="pre">261</span></code> command to generate the KPOINTS
and POTCAR files for calculating the Fermi surface.</p></li>
</ol>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>------------&gt;&gt;
261
 +-------------------------- Warm Tips --------------------------+
   \* Accuracy Levels: (1) Medium: 0.02~0.01;
                      (2) Fine:      &lt; 0.01;
   \* 0.01 is Generally Precise Enough!
 +---------------------------------------------------------------+
 Input KPT-Resolved Value (unit: 2*PI/Angstrom):
 ------------&gt;&gt;
0.008
 --&gt;&gt; (1) Reading Structural Parameters from POSCAR File...
 --&gt;&gt; (2) Written KPOINTS File!
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Submit VASP job.</p></li>
<li><p>After the VASP calculation is completed, run VASPKIT again, input
<code class="docutils literal notranslate"><span class="pre">262</span></code> command, and generate the FERMISURFACE.bxsf file containing
the Fermi surface data.</p></li>
</ol>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>------------&gt;&gt;
262
 --&gt;&gt; (1) Reading Input Parameters From INCAR File...
 --&gt;&gt; (2) Reading Structural Parameters from POSCAR File...
 --&gt;&gt; (3) Reading Fermi-Level From DOSCAR File...
ooooooooo The Fermi Energy will be set to zero eV oooooooooooooooo
 --&gt;&gt; (4) Reading Energy-Levels From EIGENVAL File...
 --&gt;&gt; (5) Written FERMISURFACE.bxsf File!
</pre></div>
</div>
<ol class="arabic simple" start="5">
<li><p>Run the XcrySDen software and follow the steps below. The fifth band
through the Fermi surface, so we choose Band Number 5, then click
Selected, and then get the Fermi surface of Cu.</p></li>
</ol>
<a class="reference internal image-reference" href="_images/fermisurface1.jpg"><img alt="_images/fermisurface1.jpg" class="align-center" src="_images/fermisurface1.jpg" style="width: 550.9px; height: 343.0px;" /></a>
<a class="reference internal image-reference" href="_images/fermisurface2.jpg"><img alt="_images/fermisurface2.jpg" class="align-center" src="_images/fermisurface2.jpg" style="width: 550.1999999999999px; height: 443.09999999999997px;" /></a>
</div>
</div>
<div class="section" id="transition-dipole-moment">
<h3>3.9 Transition Dipole Moment<a class="headerlink" href="#transition-dipole-moment" title="Permalink to this headline">¶</a></h3>
<p>The transition dipole moment (TDM) or transition moment, usually denoted
for a transition between an initial state <em>a</em> and a final state <em>b</em>, is
the electric dipole moment associated with the transition between the
two states. In general the TDM is a complex vector quantity that
includes the phase factors associated with the two states. Its direction
gives the polarization of the transition, which determines how the
system will interact with an electromagnetic wave of a given
polarization, while the square of the magnitude gives the strength of
the interaction due to the distribution of charge within the system. The
SI unit of the transition dipole moment is the Coulomb-meter (Cm); a
more conveniently sized unit is the Debye (D). The transition
probabilities between the valence and the conduction band are revealed
by the calculated sum of the squares of TDM (in unit of Debey<span class="math notranslate nohighlight">\(^2\)</span>).</p>
<p>We task cubic CsPbI<span class="math notranslate nohighlight">\(_3\)</span> perovskite phase as an example and
present the PBE calculated band structures and corresponding TDM in
figure below. This system has 44 valence electrons in all. Next we
calcualte the squares of transition dipole moment from the highest
valence band (band index 22) to the lowest conduction band (band index
23). It is found the results are well agreement with the previous
finding (see Ref. <strong>J. Phys. Chem. Lett</strong>. 2017, 8, 2999−3007).</p>
<a class="reference internal image-reference" href="_images/TDM.png"><img alt="_images/TDM.png" class="align-center" src="_images/TDM.png" style="width: 618.9px; height: 412.8px;" /></a>
<p>The calculating process is very similar with the band structure
calcuation except for setting LWAVE= .TRUE. in the INCAR file. More
details on these calculations are given in vaspkit/examples/tdm.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> ------------&gt;&gt;
71
 ============================ Optical Options ====================
 711) Linear Optical Spectrums
 712) Transition Dipole Moment at Single kpoint
 713) Transition Dipole Moment for DFT Band-Structure

 0)   Quit
 9)   Back
 ------------&gt;&gt;
713
 +-------------------------- Warm Tips --------------------------+
            See an example in vaspkit/examples/tdm.
 ONLY Support KPOINTS created by VASPKIT for hybrid bandstructure.
 +---------------------------------------------------------------+
 ======================= Band-Structure Mode ====================
 1) DFT Band-Structure Calculation
 2) Hybrid-DFT Band-Structure Calculation

 -------------&gt;&gt;
1
 Please input TWO bands separated by spaces.
 (e.g., 4 5 means to get TDM between 4 and 5 bands at all kpts)

 ------------&gt;&gt;
22 23
 +-------------------------- Warm Tips --------------------------+
   Current Version Only Support the Stardard Version of VASP code.
 +---------------------------------------------------------------+
  --&gt;&gt; (01) Reading the header information in WAVECAR file...
 +--------------------- WAVECAR Header --------------------------+
 SPIN =    1
 NKPTS =   80
 NBANDS =  36
 ENCUT =   400.00
 Coefficients Precision: Complex*8
 Maximum number of G values: GX =   11, GY =   11, GZ =   11
 Estimated maximum number of plane-waves:    5575
 +---------------------------------------------------------------+
  --&gt;&gt; (02) Start to read WAVECAR file, take your time ^.^
            Percentage complete:  25.0%
            Percentage complete:  50.0%
            Percentage complete:  75.0%
            Percentage complete: 100.0%
  --&gt;&gt; (03) Reading K-Paths From KPOINTS File...
  --&gt;&gt; (04) Start to calculate Transition Dipole Moment...
            Percentage complete:  25.0%
            Percentage complete:  50.0%
            Percentage complete:  75.0%
            Percentage complete: 100.0%
  --&gt;&gt; (05) Written TDM.dat File!
</pre></div>
</div>
<p>If one want to calculate the square of TDM between two state at single
k-point. Just run vaspkit with task 712, for example,</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>71
 ============================ Optical Options ====================
 711) Linear Optical Spectrums
 712) Transition Dipole Moment at Single kpoint
 713) Transition Dipole Moment for DFT Band-Structure

 0)   Quit
 9)   Back
 ------------&gt;&gt;
712
 +-------------------------- Warm Tips --------------------------+
             See an example in vaspkit/examples/tdm.
           Please Set LWAVE= .TRUE. in the INCAR file.
 +---------------------------------------------------------------+
 Input ONE kpoint and TWO bands separated by spaces.
 (e.g., 1 4 5 means to get TDM between 4 and 5 band at 1st kpt)

 ------------&gt;&gt;
1 22 23
 +-------------------------- Warm Tips --------------------------+
   Current Version Only Support the Stardard Version of VASP code.
 +---------------------------------------------------------------+
  --&gt;&gt; (01) Reading the header information in WAVECAR file...
 +--------------------- WAVECAR Header --------------------------+
 SPIN =    1
 NKPTS =   80
 NBANDS =  36
 ENCUT =   400.00
 Coefficients Precision: Complex*8
 Maximum number of G values: GX =   11, GY =   11, GZ =   11
 Estimated maximum number of plane-waves:    5575
 +---------------------------------------------------------------+
 Square of TDM (Debye^2):  X           Y           Z        Total
                         0.000     201.617       0.000     201.617
</pre></div>
</div>
<p>Cleary, the calculate total-square of TDM at <span class="math notranslate nohighlight">\(\text{X}\)</span> point for
cubic CsPbI<span class="math notranslate nohighlight">\(_3\)</span> is 201.62 Debey<span class="math notranslate nohighlight">\(^2\)</span>.</p>
</div>
</div>
<div class="section" id="density-of-states">
<h2>4 Density of States<a class="headerlink" href="#density-of-states" title="Permalink to this headline">¶</a></h2>
<p>VASPKIT is very powerful at post-process DOS results. Set <code class="docutils literal notranslate"><span class="pre">LORBIT</span></code> =
10 or 11, VASP will output DOS and <em>l</em>-decomposed or <em>lm</em>-decomposed
projected DOS for every atoms to DOSCAR and vasprun.xml. VASPKIT can
extract those information as users’ input.</p>
<p>Merits:</p>
<ol class="arabic simple">
<li><p>Do not need to download DOSCAR or vasprun.xml. Direct extract useful
DOS on server.</p></li>
<li><p>Selection way for PDOS is convenient. Elements, atoms, and orbitals
can be selected and sumed as you want.</p></li>
<li><p>Automatic shift fermi energy to 0 eV. It can read the E-fermi energy
form OUTCAR and shift the DOS data by E-fermi. If one do not want to
do shift, just close it in <code class="docutils literal notranslate"><span class="pre">~/.vaspkit</span></code></p></li>
</ol>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>SET_FERMI_ENERGY_ZERO    .FALSE.             # .TRUE. or .FALSE.;
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li><p>Output file can be read by ORIGIN directly with no modification.</p></li>
</ol>
<div class="section" id="extract-and-output-dos-and-pdos">
<h3>4.1 Extract and output DOS and PDOS<a class="headerlink" href="#extract-and-output-dos-and-pdos" title="Permalink to this headline">¶</a></h3>
<p>Option <code class="docutils literal notranslate"><span class="pre">11</span></code> is used to DOS post-process.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 4%" />
<col style="width: 48%" />
<col style="width: 48%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>O
p
t
i
o
n
s</p></th>
<th class="head"><p>Functions</p></th>
<th class="head"></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1
1
1</p></td>
<td><p>Get the <strong>total</strong> DOS</p></td>
<td><p><strong>Input</strong>: None.<strong>Output</strong>:
TDOS.dat contains the total
DOS; ITDOS.dat contains the
integral total DOS.Spin up and
down are written in one file.
Example: Total dos of
<span class="math notranslate nohighlight">\(\Theta\)</span>-Al2O3 unit cell</p></td>
</tr>
<tr class="row-odd"><td><p>1
1
2</p></td>
<td><p>Output projected DOS for
selected <strong>atoms</strong> to separate
files.</p></td>
<td><p><strong>Input</strong>: Input the
element-symbol and/or
atom-index to SUM [Total-atom:
80] (Free Format is OK, e.g., C
Fe H 1-4 7 8 24).<strong>Output</strong>:
SEL
ECTED_ATOM_LIST;PDOS_A_UP(_DW),
pdos file for each selected
atoms;IPDOS_A_UP(_DW), integral
pdos file for each selected
atoms;Spin up and down are
writen in different files.</p></td>
</tr>
<tr class="row-even"><td><p>1
1
3</p></td>
<td><p>Output projected DOS for every
<strong>elements</strong> to separate files.</p></td>
<td><p><strong>Input</strong>: None.<strong>Output</strong>:
PDOS_Elements_UP (_DW).dat,
pdos file for each elements
(sum of all atoms of each
element.)IPDOS_Elements_UP
(_DW).datSpin up and down are
writen in different files.</p></td>
</tr>
<tr class="row-odd"><td><p>1
1
4</p></td>
<td><p>Output <strong>sum</strong> of projected DOS
for selected atoms to one file.</p></td>
<td><p><strong>Input</strong>: Input the
element-symbol and/or
atom-index to SUM [Total-atom:
80] (Free Format is OK, e.g., C
Fe H 1-4 7 8
24).<strong>Output</strong>:SELEC
TED_ATOM_LIST;PDOS_SUM_UP(_DW),
pdos file for sum of selected
atoms;IPDOS_A_UP(_DW), integral
pdos;Spin up and down are
writen in different files.</p></td>
</tr>
<tr class="row-even"><td><p>1
1
5</p></td>
<td><p>Output <strong>sum</strong> of projected DOS
for selected atoms and orbitals
to one file.</p></td>
<td><p><strong>Input</strong>: Input the
element-symbol and/or
atom-index to SUM [Total-atom:
80] (Free Format is OK, e.g., C
Fe H 1-4 7 8 24).Input the
Orbitals to Sum. Which orbital?
s py pz px dxy dyz dz2 dxz dx2
f-3 ~ f3, “all” for summing
ALL.<strong>Output</strong>: PDOS_USER.dat
Spin up and down are writen in
one files.</p></td>
</tr>
</tbody>
</table>
<div class="section" id="example-pdos-of-co-adsorption-on-ni-100-surface">
<h4>Example: PDOS of CO adsorption on Ni(100) surface.<a class="headerlink" href="#example-pdos-of-co-adsorption-on-ni-100-surface" title="Permalink to this headline">¶</a></h4>
<p>Enter
<code class="docutils literal notranslate"><span class="pre">/vaspkit.0.73/examples/LDOS_PDOS/Partial_DOS_of_CO_on_Ni_111_surface</span></code>,</p>
<p>Run VASPKIT <code class="docutils literal notranslate"><span class="pre">(113)</span> <span class="pre">Projected</span> <span class="pre">Density-of-States</span> <span class="pre">for</span> <span class="pre">Each</span> <span class="pre">Element</span></code>,</p>
<p>VASPKIT will output <code class="docutils literal notranslate"><span class="pre">PDOS_Ni.dat</span></code>, <code class="docutils literal notranslate"><span class="pre">PDOS_C.dat</span></code>, and <code class="docutils literal notranslate"><span class="pre">PDOS_O.dat</span></code>,
which contain the PDOS information of Ni, C, and O:</p>
<a class="reference internal image-reference" href="_images/pdos1.png"><img alt="_images/pdos1.png" class="align-center" src="_images/pdos1.png" style="width: 581.0px; height: 395.5px;" /></a>
<p>Run VASPKIT
<code class="docutils literal notranslate"><span class="pre">(114)</span> <span class="pre">The</span> <span class="pre">Sum</span> <span class="pre">of</span> <span class="pre">Projected</span> <span class="pre">Density-of-States</span> <span class="pre">for</span> <span class="pre">Selected</span> <span class="pre">Atoms</span></code>, and
then input <code class="docutils literal notranslate"><span class="pre">6</span> <span class="pre">7</span></code>, VASPKIT will output the sum PDOS of CO molecule.</p>
<p>Run VASPKIT
<code class="docutils literal notranslate"><span class="pre">(115)</span> <span class="pre">The</span> <span class="pre">Sum</span> <span class="pre">of</span> <span class="pre">Projected</span> <span class="pre">DOS</span> <span class="pre">for</span> <span class="pre">Selected</span> <span class="pre">Atoms</span> <span class="pre">and</span> <span class="pre">orbitals</span></code>. If
we want s and p orbtial of O, s and p orbtial of C, d orbtial of Ni.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> Input the Symbol and/or Number of Atoms to Sum [Total-atom: 7]
 (Free Format is OK, e.g., C Fe H 1-4 7 8 24),Press &quot;Enter&quot; if you want to end e
 ntry!

 ------------&gt;&gt;
O
 Input the Orbitals to Sum
 Which orbital? s py pz px dxy dyz dz2 dxz dx2 f-3 ~ f3, &quot;all&quot; for summing ALL.
s
...
...
</pre></div>
</div>
<p>Input <code class="docutils literal notranslate"><span class="pre">O</span> <span class="pre">-</span> <span class="pre">s</span> <span class="pre">-</span> <span class="pre">O</span> <span class="pre">-</span> <span class="pre">p</span> <span class="pre">-</span> <span class="pre">C</span> <span class="pre">-</span> <span class="pre">s</span> <span class="pre">-</span> <span class="pre">C</span> <span class="pre">-</span> <span class="pre">p</span> <span class="pre">-</span> <span class="pre">Ni</span> <span class="pre">-</span> <span class="pre">d</span> <span class="pre">-</span> <span class="pre">'Enter'</span> <span class="pre">-</span> <span class="pre">0</span></code>, Then
<code class="docutils literal notranslate"><span class="pre">PDOS_USER.dat</span></code> file will generate in this folder, which contains:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>  #Energy        O_s        O_p        C_s        C_p     Ni_d
-27.10266    0.00000    0.00000    0.00000    0.00000    0.00000
-26.92966    0.00000    0.00000    0.00000    0.00000    0.00000
-26.75566    0.00000    0.00000    0.00000    0.00000    0.00000
-26.58266    0.00000    0.00000    0.00000    0.00000    0.00000
...
...
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/pdos2.png"><img alt="_images/pdos2.png" class="align-center" src="_images/pdos2.png" style="width: 849.0px; height: 290.5px;" /></a>
<p>The <code class="docutils literal notranslate"><span class="pre">Input</span> <span class="pre">the</span> <span class="pre">Symbol</span> <span class="pre">and/or</span> <span class="pre">Number</span> <span class="pre">of</span> <span class="pre">Atoms</span></code> command accept free
format input. You can enter the <code class="docutils literal notranslate"><span class="pre">1-3</span> <span class="pre">4</span> <span class="pre">Ni</span></code> to accumulate PDOS by
selecting elements 1, 2, 3, 4 and Ni. The <code class="docutils literal notranslate"><span class="pre">Input</span> <span class="pre">the</span> <span class="pre">Orbitals</span> <span class="pre">to</span> <span class="pre">Sum</span></code>
command only supports standard input. If you use <code class="docutils literal notranslate"><span class="pre">LORBIT=10</span></code>, only s p
d f can be selected. If you use <code class="docutils literal notranslate"><span class="pre">LORBIT=11</span></code>, s py pz px dxy dyz dz2
dxz dx2 f-3 f-2 f-1 f0 f1 f2 are also supported.</p>
</div>
</div>
<div class="section" id="d-band-center">
<h3>4.2 <em>d</em>-band Center<a class="headerlink" href="#d-band-center" title="Permalink to this headline">¶</a></h3>
<p>The DOS projected onto the <em>d</em>-states that interact with the adsorbate
state can be characterized by the center of d-projected DOS.</p>
<div class="math notranslate nohighlight">
\[\varepsilon_{\mathrm{d}}=\frac{\int_{-\infty}^{\infty} n_{\mathrm{d}}(\varepsilon) \varepsilon d \varepsilon}{\int_{-\infty}^{\infty} n_{\mathrm{d}}(\varepsilon) d \varepsilon}\]</div>
<p>VASPKIT option <code class="docutils literal notranslate"><span class="pre">503</span></code> can calculate d-band center for every atoms
directly from VASP DOS outputs. And users can set the the energy range
for calculation.</p>
<p>Example: Pt metal cell, the energy window is set up to the Fermi energy.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>503
 +-------------------------- Warm Tips --------------------------+
         See An Example in vaspkit/examples/d_band_center.
   d-Band Center is Sensitive to the Number of Unoccupied Band.
 Anyway, the Trends are More Important than the Absolute Energies.
 +---------------------------------------------------------------+
  --&gt;&gt; (01) Reading Input Parameters From INCAR File...
  --&gt;&gt; (02) Reading Fermi-Energy from DOSCAR File...
 ooooooooo The Fermi Energy will be set to zero eV ooooooooooooooo
  --&gt;&gt; (03) Reading DOS Data From DOSCAR File...
  --&gt;&gt; (04) Reading Structural Parameters from POSCAR File...
 +------------------------ Your Option --------------------------+
 The default energy window of integration is [-11.82 24.30]
 Do you want to change the change (Y/N)?
y
 Please enter the new energy window with blank (e.g., -10 10)
-11.8 0
 +---------------------------------------------------------------+
  --&gt;&gt; (05) Written D_BAND_CENTER File!
</pre></div>
</div>
<p>the d-band center for every atoms and the total d-band center is writen
in <code class="docutils literal notranslate"><span class="pre">D_BAND_CENTER</span></code> file as following:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># Atom ID       d-Band-Center (eV)
    Pt1:            -3.1184
  Total:            -3.1184


Notice:
The energy window of integration is [-11.80 0.00].
The calculated d-band-center presented here are referenced to Fermi level, i.e., E_F=0 eV.
</pre></div>
</div>
</div>
</div>
<div class="section" id="thermo-energy-correction">
<h2>5 Thermo Energy Correction<a class="headerlink" href="#thermo-energy-correction" title="Permalink to this headline">¶</a></h2>
<p>Calculation of the free energy change in catalysis is one of the most
important thing. But VASP do not have module that can directly
calculates molecular free energy. Thus, the free energy correction in
the some publications is inconsistent, inaccurate. (Note: Computational
chemistry programs such as Gaussian have a complete free energy
calculation module.)</p>
<div class="section" id="gas-molecule-free-energy-correction">
<h3>5.1 Gas Molecule Free Energy Correction<a class="headerlink" href="#gas-molecule-free-energy-correction" title="Permalink to this headline">¶</a></h3>
<p>The equations used for computing thermochemical data for Gas in VASPKIT
is equivalent to those in <a class="reference external" href="https://gaussian.com/thermo/">Gaussian</a>.
(<a class="reference external" href="https://gaussian.com/thermo/">https://gaussian.com/thermo/</a>) The partition function from any component
can be used to determine the entropy contribution <em>S</em> from that
component:</p>
<div class="math notranslate nohighlight">
\[S=N k_{B}+N k_{B} \ln \left(\frac{q(V, T)}{N}\right)+N k_{B} T\left(\frac{\partial \ln q}{\partial T}\right)_{V}\]</div>
<p>When molar values are given <span class="math notranslate nohighlight">\(n=N / N_{A}\)</span>, and based on Ideal gas
approximation, <span class="math notranslate nohighlight">\(N_{A} k_{B}=R\)</span>, We write the <em>S</em> as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned} S &amp;=R+R \ln (q(V, T))+R T\left(\frac{\partial \ln q}{\partial T}\right)_{V} \\ &amp;=R \ln (q(V, T) e)+R T\left(\frac{\partial \ln q}{\partial T}\right)_{V} \\ &amp;=R\left(\ln \left(q_{\mathrm{t}} q_{\mathrm{e}} q_{\mathrm{r}} q_{\mathrm{v}} e\right)+T\left(\frac{\partial \ln q}{\partial T}\right)_{V}\right) \end{aligned}\end{split}\]</div>
<p>The internal thermal energy <em>U</em> can also be obtained from the partition
function:</p>
<div class="math notranslate nohighlight">
\[U=N k_{B} T^{2}\left(\frac{\partial \ln q}{\partial T}\right)_{V}
=R T^{2}\left(\frac{\partial \ln q}{\partial T}\right)_{V}\]</div>
<p>The partition functions of translational, electronic, rotational,
vibrational contribution are calculate as the equations list in
(<a class="reference external" href="https://gaussian.com/thermo/">https://gaussian.com/thermo/</a>). Then the entropy correction and internal
thermal energy correction are calculated at specific temperature and
presure.</p>
<div class="math notranslate nohighlight">
\[U=E_{t}+E_{e}+E_{v}+E_{r}\]</div>
<div class="math notranslate nohighlight">
\[S=S_{t}+S_{e}+S_{v}+S_{r}\]</div>
<p>For linear molecules, degree of vibrational freedom is 3N - 5, VASPKIT
will neglect smallest 5 frequencies. For non-linear molecules, degree of
vibrational freedom is 3N - 6, VASPKIT will neglect smallest 6
frequencies.</p>
<p>VASPKIT also include zero-point energy (ZPE) in thermo energy correction
from the frequency calculation OUTCAR.</p>
<div class="math notranslate nohighlight">
\[\varepsilon_{\mathrm{ZPE}}=\frac{h \nu}{2}\]</div>
<p>The Gibbs free energy (<em>G</em>) and enthalpy (<em>H</em>) include ∆PV = ∆NRT based
on ideal gas approximation.</p>
<div class="math notranslate nohighlight">
\[H=U+k_{B} T\]</div>
<p>The Gibbs free energy <em>G</em> can be derived with the help of the total
entropy <em>S</em>,</p>
<div class="math notranslate nohighlight">
\[G=H-T S\]</div>
<p>At last, VASPKIT will output:</p>
<ol class="arabic simple">
<li><p>Zero-point energy <span class="math notranslate nohighlight">\(\varepsilon_{\mathrm{ZPE}}\)</span>;</p></li>
<li><p>Thermal correction to <em>U</em>(T), = <span class="math notranslate nohighlight">\(\varepsilon_{\mathrm{ZPE}}\)</span>
+ <span class="math notranslate nohighlight">\(\Delta U_{0 \rightarrow T}\)</span></p></li>
<li><p>Thermal correction to H(T), = <span class="math notranslate nohighlight">\(\varepsilon_{\mathrm{ZPE}}\)</span> +
<span class="math notranslate nohighlight">\(\Delta U_{0 \rightarrow T}\)</span> + PV =
<span class="math notranslate nohighlight">\(\varepsilon_{\mathrm{ZPE}}\)</span> +
<span class="math notranslate nohighlight">\(\Delta H_{0 \rightarrow T}\)</span></p></li>
<li><p>Thermal correction to G(T), = <span class="math notranslate nohighlight">\(\varepsilon_{\mathrm{ZPE}}\)</span> +
<span class="math notranslate nohighlight">\(\Delta U_{0 \rightarrow T}\)</span> + PV + TS =
<span class="math notranslate nohighlight">\(\varepsilon_{\mathrm{ZPE}}\)</span> +
<span class="math notranslate nohighlight">\(\Delta G_{0 \rightarrow T}\)</span></p></li>
</ol>
<p>where <span class="math notranslate nohighlight">\(\Delta U_{0 \rightarrow T}\)</span>,
<span class="math notranslate nohighlight">\(\Delta H_{0 \rightarrow T}\)</span> , and
<span class="math notranslate nohighlight">\(\Delta G_{0 \rightarrow T}\)</span> are interal energy, enthalpy, and
Gibbs free energy difference between 0 K and <em>T</em> K.</p>
<div class="section" id="example-thermo-energy-correction-for-o2-molecule">
<h4>Example: Thermo energy correction for O2 molecule:<a class="headerlink" href="#example-thermo-energy-correction-for-o2-molecule" title="Permalink to this headline">¶</a></h4>
<ol class="arabic simple">
<li><p>Do a frequency calculation. After calculation, check the
frequencies:</p></li>
</ol>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>1 f  =   46.979964 THz   295.183821 2PiTHz 1567.082879 cm-1   194.293584 meV
2 f  =    1.952595 THz    12.268518 2PiTHz   65.131565 cm-1     8.075288 meV
3 f  =    1.120777 THz     7.042052 2PiTHz   37.385108 cm-1     4.635164 meV
4 f/i=    0.006984 THz     0.043884 2PiTHz    0.232971 cm-1     0.028885 meV
5 f/i=    1.046106 THz     6.572876 2PiTHz   34.894327 cm-1     4.326347 meV
6 f/i=    1.294104 THz     8.131095 2PiTHz   43.166663 cm-1     5.351986 meV
</pre></div>
</div>
<p>Because of O2 is linear molecule, VASPKIT will neglect smallest five
frequencies.</p>
<ol class="arabic simple" start="2">
<li><p>In the same folder, run VASPKIT <code class="docutils literal notranslate"><span class="pre">502</span></code>. Input temperature(K),
pressure(Atm), and spin multiplicity in turn.</p></li>
</ol>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>502
 +-------------------------- Warm Tips --------------------------+
   See An Example in vaspkit/examples/thermo_correction/ethanol.
  This Feature Was Contributed by Nan XU, Jincheng Liu and Sobereva.
 Included Vibrations, Translation, Rotation &amp; Electron contributions.
 GAS molecules should not be with any fix.
  --&gt;&gt; (01) Reading Structural Parameters from CONTCAR File...
  --&gt;&gt; (02) Analyzing Molecular Symmetry Information...
 Molecular Symmetry is: D(inf)h
 Linear molecule found!
 +---------------------------------------------------------------+
 Please input Temperature(K)!
298.15
 Please input Pressure(Atm)!
1
 Please input Spin multiplicity!--(Number of Unpaired electron + 1)
3
 ------------&gt;&gt;
  --&gt;&gt; (03) Extracting frequencies from OUTCAR...
  --&gt;&gt; (04) Reading OUTCAR File...
  --&gt;&gt; (05) Calculating Thermal Corrections...
 U(T) = ZPE + Delta_U(0-&gt;T)
 H(T) = U(T) + PV = ZPE + Delta_U(0-&gt;T) + PV
 G(T) = H(T) - TS = ZPE + Delta_U(0-&gt;T) + PV - TS

 Zero-point energy E_ZPE   :       2.240 kcal/mol    0.097144 eV
 Thermal correction to U(T):       3.724 kcal/mol    0.161475 eV
 Thermal correction to H(T):       4.316 kcal/mol    0.187167 eV
 Thermal correction to G(T):     -10.302 kcal/mol   -0.446723 eV
 Entropy S                 :     205.141 J/(mol*K)   0.002126 eV
</pre></div>
</div>
<p>So, ZPE is 0.097144 eV. Thermal correction to <em>U</em>(T), <em>H</em>(T), and
<em>G</em>(T) are 0.161475, 0.187167, and -0.446723 eV, respectively. The
entropy correction is</p>
<div class="math notranslate nohighlight">
\[S = -[G(T)-H(T)] / T=0.0021261  \mathrm{eV} / \mathrm{K}=205.13  \mathrm{J} \cdot \mathrm{K}^{-1} \cdot \mathrm{mol}^{-1}\]</div>
<p>To get the free energy of O2, add the <em>G</em>(T) to electronic energy:</p>
<p>G(O2) = -9.854 + -0.447 = -10.301 eV</p>
</div>
</div>
<div class="section" id="adsorbed-molecular-free-energy-correction">
<h3>5.2 Adsorbed Molecular Free Energy Correction<a class="headerlink" href="#adsorbed-molecular-free-energy-correction" title="Permalink to this headline">¶</a></h3>
<p>Unlike gas molecules, adsorbed molecules form chemical bonds with
substrate, which limits the translational and rotational freedom of the
adsorbed molecules. So the contribution of translation and rotation to
entropy and enthalpy is significantly reduced (so called hindered
translator / hindered rotor model). This does not mean no translational
or rotational contribution.</p>
<p>One common method is to attribute the translational or rotational part
of the contribution to vibration, that is, the 3N vibrations of the
surface-adsorbing molecules (except the virtual frequency) are all used
to calculate the correction of the thermo energy.</p>
<p>The small the vibration frequencies have large contribution to entropy.
It is very likely that a small vibration frequency will lead to abnormal
entropy and free energy correction. So, it suggests that when the free
energy of the surface adsorption molecule is corrected, the contribution
of the frequency below 50 cm-1 is calculated as 50 cm-1, and VASPKIT
also does this. And VASPKIT neglects the electron motion because of its
small contribution.</p>
<p>And the PV term is also delete. At last VASPKIT will output:</p>
<ol class="arabic simple">
<li><p>Zero-point energy <span class="math notranslate nohighlight">\(\varepsilon_{\mathrm{ZPE}}\)</span>;</p></li>
<li><p>Thermal correction to <em>U</em>(T) = <em>H</em>(T) =
<span class="math notranslate nohighlight">\(\varepsilon_{\mathrm{ZPE}}\)</span> +
<span class="math notranslate nohighlight">\(\Delta U_{0 \rightarrow T}\)</span></p></li>
<li><p>Thermal correction to G(T) = <span class="math notranslate nohighlight">\(\varepsilon_{\mathrm{ZPE}}\)</span> +
<span class="math notranslate nohighlight">\(\Delta U_{0 \rightarrow T}\)</span> + TS =
<span class="math notranslate nohighlight">\(\varepsilon_{\mathrm{ZPE}}\)</span> +
<span class="math notranslate nohighlight">\(\Delta G_{0 \rightarrow T}\)</span></p></li>
</ol>
<div class="section" id="example-thermo-energy-correction-for-adsorbed-o-on-au-111">
<h4>Example: Thermo energy correction for adsorbed O on Au(111)<a class="headerlink" href="#example-thermo-energy-correction-for-adsorbed-o-on-au-111" title="Permalink to this headline">¶</a></h4>
<ol class="arabic simple">
<li><p>Fix all slab metal atoms, do frequency calculation for the adsorbed
molecule. Check the frequencies:</p></li>
</ol>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ grep cm OUTCAR
   1 f  =   10.904836 THz    68.517103 2PiTHz  363.746154 cm-1    45.098792 meV
   2 f  =   10.827330 THz    68.030119 2PiTHz  361.160834 cm-1    44.778253 meV
   3 f  =   10.751668 THz    67.554721 2PiTHz  358.637024 cm-1    44.465340 meV
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>In the same folder, run VASPKIT <code class="docutils literal notranslate"><span class="pre">501</span></code>. Input temperature(K).</p></li>
</ol>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>501
 +-------------------------- Warm Tips --------------------------+
 This Feature Was Contributed by Nan XU, Qiang LI and Jincheng LIU.
     See An Example in vaspkit/examples/thermo_correction/ORR.
 Only vibrations! No Translation &amp; Rotation &amp; Electron contributions.
 +---------------------------------------------------------------+

 Please Enter The Temperature (K):

 ------------&gt;&gt;
298.15
  --&gt;&gt; (01) Reading OUTCAR File...
 +-------------------------- Summary ----------------------------+
 Neglect PV contribution to translation for adsorbed molecules.
 To avoid abnormal entropy contribution,
 frequencies less than 50 cm-1 are set to 50 cm-1.
 U(T) = H(T) = ZPE + Delat_U(0-&gt;T)
 G(T) = H(T) - TS = ZPE + Delat_U(0-&gt;T) - TS

 Temperature (K): 298.1
 Zero-point energy E_ZPE   :       1.549 kcal/mol    0.067171 eV
 Thermal correction to U(T):       2.206 kcal/mol    0.095670 eV
 Thermal correction to H(T):       2.206 kcal/mol    0.095670 eV
 Thermal correction to G(T):       1.207 kcal/mol    0.052342 eV
 Entropy S                 :      14.021 J/(mol*K)   0.000145 eV
</pre></div>
</div>
<p>So, ZPE is 0.067171 eV. Thermal correction to <em>U</em>(T), <em>H</em>(T), and
<em>G</em>(T) are 0.095670, 0.187167, and -0.446723 eV, respectively.</p>
</div>
</div>
</div>
<div class="section" id="elastic-properties">
<h2>6 Elastic Properties<a class="headerlink" href="#elastic-properties" title="Permalink to this headline">¶</a></h2>
<div class="section" id="determine-elastic-constants-based-on-energy-strain-method">
<h3>6.1 Determine elastic constants based on energy-strain method<a class="headerlink" href="#determine-elastic-constants-based-on-energy-strain-method" title="Permalink to this headline">¶</a></h3>
<p>Within the linear elastic region, the stress <span class="math notranslate nohighlight">\(\boldsymbol{\sigma}\)</span>
response of solids to external loading strain
<span class="math notranslate nohighlight">\(\boldsymbol{\varepsilon}\)</span> satisfies the generalized Hooke’s law
and can be simplified in the Voigt notation</p>
<div class="math notranslate nohighlight">
\[\sigma_{i}=\sum_{j=1}^{6} c_{i j} \varepsilon_{j},\]</div>
<p>where the strain or stress are represented as a vector with 6
independent components respectively, i.e., <span class="math notranslate nohighlight">\(1 \leq i, j \leq 6\)</span>.
<span class="math notranslate nohighlight">\(C_{i j}\)</span> is the second order elastic stiffness tensor expressed
by a 6 × 6 symmetric matrix in units of GPa. The elastic stiffness
tensor <span class="math notranslate nohighlight">\(C_{i j}\)</span> can be determined based on the first-order
derivative of the stress-strain curves.</p>
<p>An alternative approach to calculate theoretical elastic constants is
based on the energy variation by applying small strains to the
equilibrium lattice configuration. The elastic energy
<span class="math notranslate nohighlight">\(\Delta E\left(V,\left\{\varepsilon_{i}\right\}\right)\)</span> of a solid
under strain in the harmonic approximation is given by</p>
<div class="math notranslate nohighlight">
\[\Delta E\left(V,\left\{\varepsilon_{i}\right\}\right)=E\left(V,\left\{\varepsilon_{i}\right\}\right)-E\left(V_{0}, 0\right)=\frac{V_{0}}{2} \sum_{i, j=1}^{6} C_{i j} \varepsilon_{j} \varepsilon_{i},\]</div>
<p>where <span class="math notranslate nohighlight">\(E\left(V,\left\{\varepsilon_{i}\right\}\right)\)</span> and <span class="math notranslate nohighlight">\(E\left(V_{0}, 0\right)\)</span>
are the total energies of the distorted and undistorted lattice cells,
with the volume of <span class="math notranslate nohighlight">\(V\)</span> and <span class="math notranslate nohighlight">\(V_0\)</span> respectively. The
energy-strain method corresponds that the elastic stiffness tensor is
derived from the second-order derivative of the total energies versus
strain. In general, the stress-strain method require higher
computational precise to achieve the same accuracy as energy-strain
method. Nevertheless, the former requires much smaller set of
distortions than the latter. Considering that the energy-strain has less
stress sensitivity than the stress-strain one, the former method has
been implemented into the VASPKIT code.</p>
<a class="reference internal image-reference" href="_images/elastic.png"><img alt="_images/elastic.png" class="align-center" src="_images/elastic.png" style="width: 410.0px; height: 406.0px;" /></a>
<p>We take diamond as an example and calculate its elastic contants
(vaspkit/examples/elastic/diamond_3D). Thera are three independent
elastic constants for FCC crystal, <span class="math notranslate nohighlight">\(\mathrm{C}_{11}\)</span>, <span class="math notranslate nohighlight">\(\mathrm{C}_{12}\)</span> and <span class="math notranslate nohighlight">\(\mathrm{C}_{44}\)</span>. Thus, the elastic energy is given by</p>
<div class="math notranslate nohighlight">
\[\begin{split}\Delta E\left(V,\left\{\varepsilon_{i}\right\}\right)=\frac{V_{0}}{2}\left[\begin{array}{cccccc}
\varepsilon_{1} &amp; \varepsilon_{2} &amp; \varepsilon_{3} &amp; \varepsilon_{4} &amp; \varepsilon_{5} &amp; \varepsilon_{6}\end{array}\right]\left[ \begin{array}{cccccc}{C_{11}} &amp; {C_{12}} &amp; {C_{12}} &amp; {0} &amp; {0} &amp; {0} \\ {C_{12}} &amp; {C_{11}} &amp; {C_{12}} &amp; {0} &amp; {0} &amp; {0} \\ {C_{12}} &amp; {C_{12}} &amp; {C_{11}} &amp; {0} &amp; {0} &amp; {0} \\ {0} &amp; {0} &amp; {0} &amp; {C_{44}} &amp; {0} &amp; {0} \\ {0} &amp; {0} &amp; {0} &amp; {0} &amp; {C_{44}} &amp; {0} \\ {0} &amp; {0} &amp; {0} &amp; {0} &amp; {0} &amp; {C_{44}}\end{array}\right]
\left[ \begin{array}{l}{\varepsilon_{1}} \\ {\varepsilon_{2}} \\ {\varepsilon_{3}} \\ {\varepsilon_{4}} \\ {\varepsilon_{5}} \\ {\varepsilon_{6}}\end{array}\right]\end{split}\]</div>
<p>To determine the elastic constants for the cubic phase, we apply the
tri-axial shear strain
<span class="math notranslate nohighlight">\(\varepsilon=(0,0,0, \delta, \delta, \delta)\)</span>, to the crystal. Then <span class="math notranslate nohighlight">\(\Delta E=\frac{V_{0}}{2}\left(C_{44} \varepsilon_{4} \varepsilon_{4}+C_{44} \varepsilon_{5} \varepsilon_{5}+C_{44} \varepsilon_{6} \varepsilon_{6}\right)\)</span>
The <span class="math notranslate nohighlight">\(C_{44}\)</span> can be calculated from
<span class="math notranslate nohighlight">\(\frac{\Delta E}{V_0}=\frac{3}{2} C_{44} \delta^{2}\)</span>.
Similarly, we appply <span class="math notranslate nohighlight">\(\varepsilon=(\delta, \delta, 0,0,0,0)\)</span> and
get <span class="math notranslate nohighlight">\(\Delta E=\frac{V}{2}\left(C_{11} \varepsilon_{1} \varepsilon_{1}+C_{11} \varepsilon_{2} \varepsilon_{2}+C_{12} \varepsilon_{1} \varepsilon_{2}+C_{12} \varepsilon_{2} \varepsilon_{1}\right)\)</span></p>
<p>Apply <span class="math notranslate nohighlight">\(\varepsilon=(\delta, \delta, \delta, 0,0,0)\)</span> to get
<span class="math notranslate nohighlight">\(\frac{\Delta E}{V_0}=\frac{3}{2}\left(C_{11}+2 C_{12}\right) \delta^{2}\)</span>。</p>
<p>Finally, math::` mathrm{C}_{11}`, math::` mathrm{C}_{12}` and math::` mathrm{C}_{44}` can be calcauclated by solving these equations.</p>
<p>The relationship of lattice vectors between distorted and fully relaxed
lattice cells is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left( \begin{array}{l}{\boldsymbol{a}^{\prime}} \\ {\boldsymbol{b}^{\prime}} \\ {\boldsymbol{c}^{\prime}}\end{array}\right)=\left( \begin{array}{l}{\boldsymbol{a}} \\ {\boldsymbol{b}} \\ {\boldsymbol{c}}\end{array}\right) \cdot(\boldsymbol{I}+\boldsymbol{\varepsilon})\end{split}\]</div>
<p>where math::` boldsymbol{I}` is the identity matrix, The strain tensor</p>
<p><span class="math notranslate nohighlight">\(\boldsymbol{\varepsilon}\)</span> is defined by</p>
<div class="math notranslate nohighlight">
\[\begin{split}\boldsymbol{\varepsilon}=\left( \begin{array}{ccc}{\varepsilon_{1}} &amp; {\frac{\varepsilon_{6}}{2}} &amp; {\frac{\varepsilon_{5}}{2}} \\ {\frac{\varepsilon_{6}}{2}} &amp; {\varepsilon_{2}} &amp; {\frac{\varepsilon_{4}}{2}} \\ {\frac{\varepsilon_{5}}{2}} &amp; {\frac{\varepsilon_{4}}{2}} &amp; {\varepsilon_{3}}\end{array}\right)\end{split}\]</div>
<p><strong>Fisrt Step：Prepare the following files：</strong></p>
<ol class="arabic simple">
<li><p>Prepare the fully-relaxed POSCAR file including the standard
conventional cell of diamond. You can get the standard conventional
cell by running vaspkit with task of 603/604;</p></li>
<li><p>Run vaspkit with task of 102 to generate KPOINTS with fine k-mesh.</p></li>
<li><p>Prepare INCAR as follows.</p></li>
</ol>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Global Parameters
  ISTART =  0
  LREAL  =  F
  PREC   =  High
  LWAVE  = F
  LCHARG = F
  ADDGRID= .TRUE.
Electronic Relaxation
  ISMEAR =  0
  SIGMA  =  0.05
  NELM   =  40
  NELMIN =  4
  EDIFF  =  1E-08
Ionic Relaxation
  NELMIN =  6
  NSW    =  100
  IBRION =  2
  ISIF   =  2    （Must be 2）
  EDIFFG = -1E-02
</pre></div>
</div>
<p>4，Prepare VPKIT.in file and set the value of firt line to 1 (1 means
pre-processing)；</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>1                    ! 1 for pre-processing; 2 for post-processing
3D                   ! 2D for two-dimentional, 3D for bulk
7                    ! number of strain case
-0.015 -0.010 -0.005 0.000 0.005 0.010 0.015  ! Strain range
</pre></div>
</div>
<p>and run vaspkit-201</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> ------------&gt;&gt;
201
  --&gt;&gt; (01) Reading VPKIT.in File...
 +-------------------------- Warm Tips --------------------------+
      See an example in vaspkit/examples/elastic/diamond_3D,
   Require the fully-relaxed and standardized Convertional cell.
 +---------------------------------------------------------------+
  --&gt;&gt; (02) Reading Structural Parameters from POSCAR File...
   -&gt; C44 folder created successfully!
   -&gt; strain_-0.015 folder created successfully!
   -&gt; strain_-0.010 folder created successfully!
   -&gt; strain_-0.005 folder created successfully!
   -&gt; strain_0.000 folder created successfully!
   -&gt; strain_+0.005 folder created successfully!
   -&gt; strain_+0.010 folder created successfully!
   -&gt; strain_+0.015 folder created successfully!
   -&gt; C11_C12_I folder created successfully!
   -&gt; strain_-0.015 folder created successfully!
   -&gt; strain_-0.010 folder created successfully!
   -&gt; strain_-0.005 folder created successfully!
   -&gt; strain_0.000 folder created successfully!
   -&gt; strain_+0.005 folder created successfully!
   -&gt; strain_+0.010 folder created successfully!
   -&gt; strain_+0.015 folder created successfully!
   -&gt; C11_C12_II folder created successfully!
   -&gt; strain_-0.015 folder created successfully!
   -&gt; strain_-0.010 folder created successfully!
   -&gt; strain_-0.005 folder created successfully!
   -&gt; strain_0.000 folder created successfully!
   -&gt; strain_+0.005 folder created successfully!
   -&gt; strain_+0.010 folder created successfully!
   -&gt; strain_+0.015 folder created successfully!
</pre></div>
</div>
<p><strong>Second step: Batch performing DFT calucaltions using VASP code；</strong></p>
<p><strong>Third step: Modify the value of the first line in VPKIT.in file to 2
(2 means post-processing); and run vaspkit-201 again.</strong>You will get
the following information,</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> ------------&gt;&gt;
201
  --&gt;&gt; (01) Reading VPKIT.in File...
 +-------------------------- Warm Tips --------------------------+
      See an example in vaspkit/examples/elastic/diamond_3D,
   Require the fully-relaxed and standardized Convertional cell.
 +---------------------------------------------------------------+
  --&gt;&gt; (02) Reading Structural Parameters from POSCAR File...
  --&gt;&gt; (03) Calculating the fitting coefficients of energy vs strain.
 --&gt;&gt; Current directory: Fitting Precision
                    C44:  0.817E-09
              C11_C12_I:  0.814E-08
             C11_C12_II:  0.135E-07
 +-------------------------- Summary ----------------------------+
 Based on the Strain versus Energy method.
 Crystal Class: m-3m
 Space Group: Fd-3m
 Crystal System: Cubic system
 Including Point group classes: 23, 2/m-3, 432, -43m, 4/m-32/m
 There are 3 independent elastic constants
    C11  C12  C12    0    0    0
    C12  C11  C12    0    0    0
    C12  C12  C11    0    0    0
      0    0    0  C44    0    0
      0    0    0    0  C44    0
      0    0    0    0    0  C44

 Stiffness Tensor C_ij (in GPa):
   1050.640    126.640    126.640      0.000      0.000      0.000
    126.640   1050.640    126.640      0.000      0.000      0.000
    126.640    126.640   1050.640      0.000      0.000      0.000
      0.000      0.000      0.000    559.861      0.000      0.000
      0.000      0.000      0.000      0.000    559.861      0.000
      0.000      0.000      0.000      0.000      0.000    559.861

 Compliance Tensor S_ij (in GPa^{-1}):
   0.000977  -0.000105  -0.000105   0.000000   0.000000   0.000000
  -0.000105   0.000977  -0.000105   0.000000   0.000000   0.000000
  -0.000105  -0.000105   0.000977   0.000000   0.000000   0.000000
   0.000000   0.000000   0.000000   0.001786   0.000000   0.000000
   0.000000   0.000000   0.000000   0.000000   0.001786   0.000000
   0.000000   0.000000   0.000000   0.000000   0.000000   0.001786

 Elastic stability criteria as discussed in PRB 90, 224104 (2014):
 Criteria (i) C11 - C12 &gt; 0 meeted.
 Criteria (ii) C11 + 2C12 &gt; 0 meeted.
 Criteria (iii) C44 &gt; 0 meeted.

 Average mechanical properties for polycrystalline:
 +---------------------------------------------------------------+
 |        Scheme             |   Voigt   |   Reuss   |    Hill   |
 +---------------------------------------------------------------+
 |  Bulk modulus K (GPa)     |  434.640  |  434.640  |  434.640  |
 |  Shear modulus G (GPa)    |  520.716  |  516.130  |  518.423  |
 |  Young&#39;s modulus E (GPa)  | 1116.342  | 1109.298  | 1112.824  |
 |  P-wave modulus (GPa)     | 1128.929  | 1122.814  | 1125.871  |
 |  Poisson&#39;s ratio v        |    0.072  |    0.075  |    0.073  |
 |  Bulk/Shear ratio         |    0.835  |    0.842  |    0.838  |
 +---------------------------------------------------------------+
 Pugh Ratio: 1.193
 Cauchy Pressure (GPa): -433.220
 Universal Elastic Anisotropy: 0.044
 Chung–Buessem Anisotropy:    0.004
 Isotropic Poisson’s Ratio: 0.073
 Longitudinal wave velocity (in m/s):  17945.173
 Transverse wave velocity (in m/s):  12177.146
 Average wave velocity (in m/s):  13280.911
 Debye temperature (in K): 2212.889
 References:
 [1] Voigt W, Lehrbuch der Kristallphysik (1928)
 [2] Reuss A, Z. Angew. Math. Mech. 9 49–58 (1929)
 [3] Hill R, Proc. Phys. Soc. A 65 349–54 (1952)
 [4] Debye temperature J. Phys. Chem. Solids 24, 909-917 (1963)
 [5] Elastic wave velocities calculated using Navier&#39;s equation
</pre></div>
</div>
<p>The calcualted elastic contants are well agreement with the available
experimental values, <span class="math notranslate nohighlight">\(C_{11}=1079\)</span> GPa, <span class="math notranslate nohighlight">\(C_{12}=124\)</span> GPa and
<span class="math notranslate nohighlight">\(C_{44}=578\)</span> GPa. VASPKIT can also read elastic constants from
OUTCAR/ELASTIC_TENSOR.in file and determine various mechanical
properites and elastic stability criterion. For more details, see
vaspkit/examples/elastic.</p>
</div>
</div>
<div class="section" id="optic-properties">
<h2>7 Optic Properties<a class="headerlink" href="#optic-properties" title="Permalink to this headline">¶</a></h2>
<p>The linear optical properties can be obtained from the
frequency-dependent complex dielectric function
<span class="math notranslate nohighlight">\(\varepsilon(\omega)\)</span></p>
<div class="math notranslate nohighlight">
\[\varepsilon(\omega)=\varepsilon_{1}(\omega)+i \varepsilon_{2}(\omega),\]</div>
<p>where <span class="math notranslate nohighlight">\(\varepsilon_{1}(\omega)\)</span> and
<span class="math notranslate nohighlight">\(\varepsilon_{2}(\omega)\)</span> are the real and imaginary parts of the
dielectric function, and <span class="math notranslate nohighlight">\(\omega\)</span> is the photon frequency.</p>
<p>The frequency-dependent linear optical spectra, e.g., refractive index <span class="math notranslate nohighlight">\(n(\omega)\)</span>,
extinction coefficient <span class="math notranslate nohighlight">\(\kappa(\omega)\)</span>,
absorption coefficient <span class="math notranslate nohighlight">\(\alpha(\omega)\)</span>,
energy-loss function <span class="math notranslate nohighlight">\(L(\omega)\)</span>,
reflectivity <span class="math notranslate nohighlight">\(R(\omega)\)</span> can be calculated from the real <span class="math notranslate nohighlight">\(\varepsilon_{1}(\omega)\)</span> and <span class="math notranslate nohighlight">\(\varepsilon_{2}(\omega)\)</span> parts [See Ref. A. M. Fox, <em>Optical Properties of Solids</em>]:</p>
<div class="math notranslate nohighlight">
\[n(\omega)=\left[\frac{\sqrt{\varepsilon_{1}^{2}+\varepsilon_{2}^{2}}+\varepsilon_{1}}{2}\right]^{\frac{1}{2}}\]</div>
<div class="math notranslate nohighlight">
\[k(\omega)=\left[\frac{\sqrt{\varepsilon_{1}^{2}+\varepsilon_{2}^{2}}-\varepsilon_{1}}{2}\right]^{\frac{1}{2}}\]</div>
<div class="math notranslate nohighlight">
\[\alpha(\omega)=\frac{\sqrt{2} \omega}{c}\left[\sqrt{\varepsilon_{1}^{2}+\varepsilon_{2}^{2}}-\varepsilon_{1}\right]^{\frac{1}{2}}\]</div>
<div class="math notranslate nohighlight">
\[L(\omega)=\operatorname{Im}\left(\frac{-1}{\varepsilon(\omega)}\right)=\frac{\varepsilon_{2}}{\varepsilon_{1}^{2}+\varepsilon_{2}^{2}}\]</div>
<div class="math notranslate nohighlight">
\[R(\omega)=\frac{(n-1)^{2}+k^{2}}{(n+1)^{2}+k^{2}}\]</div>
<p>In VASPKIT Ver. 1.00 or later, it is not necessary to run optical.sh to
extract image and real parts of dielectric function from vasprun.xml at
first step (optional). You can run vaspkit -task 711 to get the these
linear optical spectrums at one shot. The program will read dielectric
function from vasprun.xml directely if both REAL.in and IMAG.in files
not exist. We take Si as an example and calcuculate its optical
properties at GW0+BSE leve, as shown in figure below.</p>
<a class="reference internal image-reference" href="_images/optical.png"><img alt="_images/optical.png" class="align-center" src="_images/optical.png" style="width: 550.0px; height: 441.6px;" /></a>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> ------------&gt;&gt;
71
 ============================ Optical Options ====================
 711) Linear Optical Spectrums
 712) Transition Dipole Moment at Single kpoint
 713) Transition Dipole Moment for DFT Band-Structure

 0)   Quit
 9)   Back
 ------------&gt;&gt;
711
 +-------------------------- Warm Tips --------------------------+
         See an example in vaspkit/examples/Si_bse_optical.
     This module is NOT suitable for low-dimensional materials.
 +---------------------------------------------------------------+
 ===================== Energy Unit ===============================
 Which Energy Unit Do You Want to Adopt?
 1) eV
 2) nm
 3) THz
 ------------&gt;&gt;
1
  --&gt;&gt; (01) Reading Dielectric Function From vasprun.xml File...
  --&gt;&gt; (02) Reading IMAG.in and REAL.in Files...
  --&gt;&gt; (03) Written Optical Files Succesfully!
 +---------------------------------------------------------------+
 |                         * DISCLAIMER *                        |
 |      Check the Consistency of Your Results if Necessary       |
 |         Any Suggestions for Improvements are Welcome          |
 |                     (^.^) GOOD LUCK (^.^)                     |
 |---------------------------------------------------------------|
 | We Would Appreciate if You Cite in Your Research with VASPKIT.|
 | Ref. V. Wang, N. Xu, J.C. LIU, VASPKIT: A Pre- and Post-Proces|
 | sing Program for the VASP Code. http://vaspkit.sourceforge.net|
 +---------------------------------------------------------------+
</pre></div>
</div>
</div>
<div class="section" id="structure-and-symmetry-tools">
<h2>8 Structure and Symmetry Tools<a class="headerlink" href="#structure-and-symmetry-tools" title="Permalink to this headline">¶</a></h2>
<p>VASPKIT is powerful at structure edition. Read and modify the structural
files.</p>
<div class="section" id="redefine-lattice">
<h3>8.1 Redefine Lattice<a class="headerlink" href="#redefine-lattice" title="Permalink to this headline">¶</a></h3>
<p>VASPKIT option <code class="docutils literal notranslate"><span class="pre">400</span></code> can build supercell and rotate the lattice
vector. It requires three coefficients for each new vector by following
equation:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left(\begin{array}{l}{A} \\ {B} \\ {C}\end{array}\right)=\left(\begin{array}{lll}{c_1} &amp; {c_2} &amp; {c_3} \\ {c_4} &amp; {c_5} &amp; {c_6} \\ {c_7} &amp; {c_8} &amp; {c_9}\end{array}\right)\left(\begin{array}{l}{a} \\ {b} \\ {c}\end{array}\right)\end{split}\]</div>
<p><strong>A</strong>, <strong>B</strong>, and <strong>C</strong> are new lattice vectors, <strong>a</strong>, <strong>b</strong>, and <strong>c</strong>
are old lattice vectors.</p>
<p>Example: Build <span class="math notranslate nohighlight">\(\operatorname{Au}(111)-(\sqrt{3} \times \sqrt{3}) R 30^{\circ}\)</span> slab from primitive slab</p>
<a class="reference internal image-reference" href="_images/supercell1.png"><img alt="_images/supercell1.png" class="align-center" src="_images/supercell1.png" style="width: 759.2px; height: 264.8px;" /></a>
<p>Build a supercell with its length of new lattice vector equal to
<span class="math notranslate nohighlight">\(\sqrt{3}\)</span>a.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>400

  --&gt;&gt; (01) Reading Structural Parameters from POSCAR File...
 Enter the new lattice verctor a in terms of old:
 (MUST be three integers, e.g., 1 2 3)
1 -1 0
 Enter the new lattice verctor b in terms of old:
2 1 0
 Enter the new lattice verctor c in terms of old:
0 0 1
 +-------------------------- Summary ----------------------------+
 The Transformation Matrix P is:
   1  -1   0
   2   1   0
   0   0   1
 Lattice Constants in New Cell:   4.995   4.995  17.064
 Lattice Angles in New Cell:   90.00   90.00   60.00
 Total Atoms in New Cell:
 Volume of New Cell is 3 times of the Old Cell
</pre></div>
</div>
</div>
<div class="section" id="build-supercell">
<h3>8.2 Build Supercell<a class="headerlink" href="#build-supercell" title="Permalink to this headline">¶</a></h3>
<p>VASPKIT <code class="docutils literal notranslate"><span class="pre">401</span></code> can build supercell by three number C1, C2, C3.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left(\begin{array}{l}{A} \\ {B} \\ {C}\end{array}\right)=\left(\begin{array}{lll}{c_{1}} &amp; {c_{2}} &amp; {c_{3}}\end{array}\right)\left(\begin{array}{l}{a} \\ {b} \\ {c}\end{array}\right)\end{split}\]</div>
<p>For example, build supercell with length is 2 times in the <strong>a</strong> and
<strong>b</strong> direction and keep the <strong>c</strong> vector.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>401
 ===================== Structural File ===========================
 1) POSCAR
 2) CONTCAR
 3) The Specified Filename

 0) Quit
 9) Back
 ------------&gt;&gt;
1
  --&gt;&gt; (01) Reading Structural Parameters from POSCAR File...
 +-------------------------- Warm Tips --------------------------+
 Enter the repeated unit along a, b and c directions with space!
 (MUST be three integers, e.g., 1 2 3)

 ------------&gt;&gt;
2 2 1
  --&gt;&gt; (02) Written SC221.vasp File
</pre></div>
</div>
</div>
<div class="section" id="fix-atoms-by-layers">
<h3>8.3 Fix Atoms by Layers<a class="headerlink" href="#fix-atoms-by-layers" title="Permalink to this headline">¶</a></h3>
<p>VASP default structural optimization allows all atoms to move freely in
all directions (x, y, z). In some cases, structural optimization
calculations require to fix some atoms. For example, surface
calculations with slab model need to fix some bottom atoms.</p>
<p>To fix atoms, the POSCAR seventh line should be switched to
<code class="docutils literal notranslate"><span class="pre">selective</span> <span class="pre">dynamics</span></code> (only the first character is relevant and must be
<code class="docutils literal notranslate"><span class="pre">S</span></code> or <code class="docutils literal notranslate"><span class="pre">s</span></code>). This mode allows to provide extra flags for each atom
signaling whether the respective coordinate(s) of this atom will be
allowed to change during the ionic relaxation. <code class="docutils literal notranslate"><span class="pre">F</span></code> means fix, and
<code class="docutils literal notranslate"><span class="pre">T</span></code> means not fix.</p>
<p>VASPKIT provides options <code class="docutils literal notranslate"><span class="pre">402</span></code> to fix atoms by layers:</p>
<ol class="arabic simple">
<li><p>Input the file name that we want to fix. <code class="docutils literal notranslate"><span class="pre">1</span></code> for POSCAR, <code class="docutils literal notranslate"><span class="pre">2</span></code> for
CONTCAR, <code class="docutils literal notranslate"><span class="pre">3</span></code> for specified name but should also be POSCAR format.</p></li>
<li><p>Input a threshold (unit: Å) to separate layers. Only atomic layers’
z coordinates difference is bigger than the threshold, those layers
can be recognized. Otherwise, it will be recognized to be one layer.
VASPKIT shows some suggested threshold and its corresponding layers
number.</p></li>
</ol>
<p>Then VASPKIT will print the recognized layers number.</p>
<ol class="arabic simple" start="3">
<li><p>Choose the layers that we want to fix. VASPKIT will automitically
fix those bottom layers and output a <code class="docutils literal notranslate"><span class="pre">POSCAR_FIX</span></code> file. Before
VASP calcualtion, <code class="docutils literal notranslate"><span class="pre">cp</span> <span class="pre">POSCAR_FIX</span> <span class="pre">POSCAR</span></code>.</p></li>
</ol>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> 402
 ===================== Structural File ===========================
 1) POSCAR
 2) CONTCAR
 3) The Specified Filename

 0) Quit
 9) Back
 ------------&gt;&gt;
1
  --&gt;&gt; (01) Reading Structural Parameters from POSCAR File...
 Threshold:  0.3 layers:   4
 Threshold:  0.6 layers:   4
 Threshold:  0.9 layers:   4
 Threshold:  1.2 layers:   4
 Threshold:  1.5 layers:   4
 Please choose a threshold to separate layers-&gt;
1
 Found 4 layers, choose how many layers to be fixed=&gt;
2
Fixed atoms are:    1   4
  --&gt;&gt; (02) Written POSCAR_FIX File!
</pre></div>
</div>
</div>
<div class="section" id="fix-atoms-by-height">
<h3>8.4 Fix Atoms by Height<a class="headerlink" href="#fix-atoms-by-height" title="Permalink to this headline">¶</a></h3>
<p>VASPKIT <code class="docutils literal notranslate"><span class="pre">403</span></code> can also fix atoms, but by a range of z coordinates.
Similar as the option <code class="docutils literal notranslate"><span class="pre">402</span></code>, first select a structural file, and then
input two numbers to set the z coordinate range. Then, select the output
format <code class="docutils literal notranslate"><span class="pre">Fractional</span></code> or <code class="docutils literal notranslate"><span class="pre">Cartesian</span></code>. it will output <code class="docutils literal notranslate"><span class="pre">POSCAR_FIX</span></code>
file.</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">(1)</span> <span class="pre">Fractional</span> <span class="pre">coordinates</span></code> is select, the input
<code class="docutils literal notranslate"><span class="pre">z_min</span> <span class="pre">z_max</span></code> numbers should be the z fractional coordination and the
output file <code class="docutils literal notranslate"><span class="pre">POSCAR_FIX</span></code> also is written as fractional style.</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">(2)</span> <span class="pre">Cartesian</span> <span class="pre">coordinates</span></code> is select, the input
<code class="docutils literal notranslate"><span class="pre">z_min</span> <span class="pre">z_max</span></code> numbers should be the z Cartesian coordination and the
output file <code class="docutils literal notranslate"><span class="pre">POSCAR_FIX</span></code> also is written as Cartesian style.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>403
 ===================== Structural File ===========================
 1) POSCAR
 2) CONTCAR
 3) The Specified Filename

 0) Quit
 9) Back
 ------------&gt;&gt;
1
  --&gt;&gt; (01) Reading Structural Parameters from POSCAR File...
 +---------------------------------------------------------------+
 |               Selective Dynamics is Activated!                |
 +---------------------------------------------------------------+
 Atoms between your chosen section in z direction will be fixed
 Type z_min z_max, Note: z_min &lt; z_max
0 5
 Read and Write atomic coordinates as:
 (1) Fractional coordinates
 (2) Cartesian coordinates
2
Fixed atoms are:    1   4
  --&gt;&gt; (02) Written POSCAR_FIX File!
</pre></div>
</div>
</div>
<div class="section" id="swap-axis-of-lattice-vector">
<h3>8.5 Swap Axis of Lattice Vector<a class="headerlink" href="#swap-axis-of-lattice-vector" title="Permalink to this headline">¶</a></h3>
<p>VASPKIT <code class="docutils literal notranslate"><span class="pre">407</span></code> can do swap two axis of lattice vector.</p>
</div>
<div class="section" id="symmetry-tools">
<h3>8.6 Symmetry Tools<a class="headerlink" href="#symmetry-tools" title="Permalink to this headline">¶</a></h3>
<p>VASPKIT can identify symmetry of crystal from POSCAR or CONTCAR by
<code class="docutils literal notranslate"><span class="pre">601</span></code> or<code class="docutils literal notranslate"><span class="pre">608</span></code>, respectively.</p>
<p>For example <span class="math notranslate nohighlight">\(\theta\)</span>-Al2O3:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>601
  --&gt;&gt; (01) Reading Structural Parameters from POSCAR File...
 +-------------------------- Summary ----------------------------+
              Prototype: A2B3
            Total Atoms:  10
           Formula Unit: Al2O3  [ Alphabetically Listed: Al2O3 ]
      Full Formula Unit: Al4O6
         Crystal System: Monoclinic
          Crystal Class: 2/m
        Bravais Lattice: mC
      Lattice Constants:   6.142   6.142   5.671
         Lattice Angles:  76.387 103.613 152.294
                 Volume:  96.475
        Density (g/cm3):   3.510
            Space Group:  12
            Point Group:  5 [ C2h ]
          International: C2/m
    Symmetry Operations:   4
</pre></div>
</div>
<p>If POSCAR is conventional cell, VASPKIT <code class="docutils literal notranslate"><span class="pre">602</span></code> can transfer it to
primitive Cell.</p>
<p>If POSCAR is primitive cell, VASPKIT <code class="docutils literal notranslate"><span class="pre">602</span></code> can transfer it to
conventional Cell.</p>
<p>VASPKIT can also identify point group of molecule from POSCAR <code class="docutils literal notranslate"><span class="pre">609</span></code>,</p>
<p>For example: point group of O2 molecule is <span class="math notranslate nohighlight">\(D_{\infty h}\)</span>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>6
 =================== Symmetry Options ============================
 601) Symmetry Finding for Crystals
 602) Primitive Cell Finding
 603) Conventional Cell Finding (experimental)
 604) Standardize Crystal Cell
 608) Summary for Relaxed-Structure
 609) Symmetry Finding for Molecules and Clusters

 0)   Quit
 9)   Back
 ------------&gt;&gt;
609

  --&gt;&gt; (01) Reading Structural Parameters from CONTCAR File...
  --&gt;&gt; (02) Analyzing Molecular Symmetry Information...
 Molecular Symmetry is: D(inf)h
</pre></div>
</div>
</div>
</div>
<div class="section" id="potential-related">
<h2>9 Potential related<a class="headerlink" href="#potential-related" title="Permalink to this headline">¶</a></h2>
<div class="section" id="planar-average-potential">
<h3>9.1 Planar Average Potential<a class="headerlink" href="#planar-average-potential" title="Permalink to this headline">¶</a></h3>
<p>Planar average for grid files is one of the basic function of VASPKIT.
It supports all grid files of VASP output, such as CHGCAR, PARCHG,
LOCPOT, ELFCAR. All such grid files are written by following commands in
Fortran:</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="k">WRITE</span><span class="p">(</span><span class="n">IU</span><span class="p">,</span><span class="n">FORM</span><span class="p">)</span> <span class="p">(((</span><span class="n">C</span><span class="p">(</span><span class="n">NX</span><span class="p">,</span><span class="n">NY</span><span class="p">,</span><span class="n">NZ</span><span class="p">),</span><span class="n">NX</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NGXC</span><span class="p">),</span><span class="n">NY</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NGYZ</span><span class="p">),</span><span class="n">NZ</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NGZC</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/avgpot1.png"><img alt="_images/avgpot1.png" class="align-center" src="_images/avgpot1.png" style="width: 636.8000000000001px; height: 230.0px;" /></a>
<p>For one selected direction, such as z direction. VASPKIT do an average
in XY plane on each NZ,</p>
<div class="math notranslate nohighlight">
\[\sum_{i j} \Delta x_{i} \Delta y_{j} \rho_{i, j} / \sum_{i j} \Delta x_{i} \Delta y_{j}\]</div>
<p>The output <code class="docutils literal notranslate"><span class="pre">POTPAVG.dat</span></code> contains two columns. First column is z
coordinate (in Å), Second column is Planar Average-Potential (in eV) or
Densitiy (in e).</p>
<p>Here, take LOCPOT as an example. It contains total local potential (in
eV) when <code class="docutils literal notranslate"><span class="pre">LVTOT</span>&#160;&#160; <span class="pre">=</span>&#160; <span class="pre">.TRUE.</span></code> exists in the INCAR file, or contains
electrostatic potential (in eV) when <code class="docutils literal notranslate"><span class="pre">LVHAR</span> <span class="pre">=</span> <span class="pre">.TRUE.</span></code> exists in the
INCAR file. Electrostatic potential is desirable for the evaluation of
the work-function, because the electrostatic potential converges more
rapidly to the vacuum level than the total potential. To get the
work-function, potential along z direction (i.e. slab normal direction)
must be averaged in the slab planes.</p>
<p>Hamiltonian of Kohn-Sham is:</p>
<div class="math notranslate nohighlight">
\[\hat{H}=-\frac{1}{2} \nabla^{2}-\sum_{A} \frac{Z_{A}}{\left|\boldsymbol{r}-\boldsymbol{R}_{A}\right|}+\int_{\infty} \frac{\rho\left(\boldsymbol{r}^{\prime}\right)}{\left|\boldsymbol{r}-\boldsymbol{r}^{\prime}\right|} d \boldsymbol{r}^{\prime}+v_{x c}[\rho(\boldsymbol{r})]\]</div>
<p>Electrostatic potential is the summation of second (ionic) and third
(hartree) parts of Hamiltonian .</p>
<div class="section" id="example-work-function-of-au-111-slab-with-five-atomic-layers">
<h4>Example, Work-function of Au(111) slab with five atomic layers.<a class="headerlink" href="#example-work-function-of-au-111-slab-with-five-atomic-layers" title="Permalink to this headline">¶</a></h4>
<ol class="arabic simple">
<li><p>Do an optimization and a single-point calculation to get the LOCPOT
file, single-point INCAR as following:</p></li>
</ol>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>##### initial parameters I/O #####
SYSTEM = Au
NCORE = 5
ISTART = 1
ICHARG = 1
LWAVE = .TRUE.
LCHARG = .TRUE.
LVTOT = .FALSE.
LVHAR = .TRUE.
LELF = .FALSE.

#### Electronic Relaxation ####
ENCUT = 400
ISMEAR = 1
SIGMA = 0.2
EDIFF = 1E-6
NELMIN = 5
NELM = 300
GGA = PE
LREAL = Auto
IDIPOL = 3
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Run VASPKIT <code class="docutils literal notranslate"><span class="pre">426</span></code> function, and select the surface normal
direction:</p></li>
</ol>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>426
 +-------------------------- Warm Tips --------------------------+
                  You MUST Know What You are Doing
   Check Convergence of Planar Average Value on Vacuum-Thickness!
 +---------------------------------------------------------------+
 ===================== Specified Direction =======================
 Which Direction is for the Planar Average?
 1) x Direction
 2) y Direction
 3) z Direction

 0) Quit
 9) Back
 ------------&gt;&gt;
3
 --&gt;&gt; (1) Reading Structural Parameters from LOCPOT File...
 --&gt;&gt; (2) Reading Local Potential From LOCPOT File...
 --&gt;&gt; (3) Written POTPAVG.dat File!
 +-------------------------- Warm Tips --------------------------+
  Check the Convergence of Vacuum-Level Versus Vacuum Thickness!
 +---------------------------------------------------------------+
 +-------------------------- Summary ----------------------------+
 Vacuum-Level  (eV):    6.695
 +---------------------------------------------------------------+
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/avgpot2.png"><img alt="_images/avgpot2.png" class="align-center" src="_images/avgpot2.png" style="width: 700.0px; height: 420.0px;" /></a>
<a class="reference internal image-reference" href="_images/avgpot3.png"><img alt="_images/avgpot3.png" class="align-center" src="_images/avgpot3.png" style="width: 676.1999999999999px; height: 173.4px;" /></a>
<p>So, the Vacuum-Level is <code class="docutils literal notranslate"><span class="pre">6.695</span></code>, POTPAVG.dat as following:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># Planar Distance (in Angstrom), Planar Average-Potential (in eV) or -Densitiy (in e)
 0.0000    0.27377302E+01
 0.1025    0.94832051E+00
 0.2049   -0.13842911E+01
 0.3074   -0.40872693E+01
 0.4099   -0.69356914E+01
 0.5123   -0.96882699E+01
 0.6148   -0.12150765E+02
 0.7172   -0.14164741E+02
 ...
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Get the fermi level by:</p></li>
</ol>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>grep E-fermi OUTCAR
E-fermi :   1.5199     XC(G=0):  -6.7056     alpha+bet : -6.4642
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li><p>Draw the Plane-averaged electrostatic potential figure.</p></li>
</ol>
<p>So, work function can be calculated as:</p>
<div class="math notranslate nohighlight">
\[\Phi=E_{\mathrm{vac}}-E_{\mathrm{F}}\]</div>
<p><span class="math notranslate nohighlight">\(\Phi\)</span> = 6.695 - 1.5199 = 5.1751 eV</p>
</div>
</div>
<div class="section" id="macroscopic-averaged-potential">
<h3>9.2 Macroscopic Averaged Potential<a class="headerlink" href="#macroscopic-averaged-potential" title="Permalink to this headline">¶</a></h3>
<p>Besides planar averaged potential , VASPKIT can also calculate
macroscopic-averaged potential, which is obtained by converging the
planar averaged potential with a moving average. e.g. If one want to do
planar-averaged potential in z-direction, use z = average(x, y) for
every z. If one want to do macroscopic-averaged potential in z-dirction,
use z = average(x, y, z ± <span class="math notranslate nohighlight">\(\Delta\)</span>z’) for every z, where
2<span class="math notranslate nohighlight">\(\Delta\)</span>z’ is the layer distance for repeat structures.</p>
<p>For example: MoS2/WS2 heterogeneous junction.</p>
<ol class="arabic simple">
<li><p>Do a single-point calculation with <code class="docutils literal notranslate"><span class="pre">LVHAR</span> <span class="pre">=</span> <span class="pre">.TRUE.</span></code>,</p></li>
<li><p>Run VASPKIT <code class="docutils literal notranslate"><span class="pre">427</span></code> to obtain planar averaged potential and
macroscopic averaged potential from LOCPOT.</p></li>
</ol>
<ol class="arabic simple">
<li><p>Select which direction to do planar average?</p></li>
<li><p>Input the period length to calculate macroscopic average. (To
accelerate the convergence, this value should be close to and smaller
than the layer distance)</p></li>
<li><p>Input iteration number to get smoother macroscopic curve.</p></li>
</ol>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>427
 +-------------------------- Warm Tips --------------------------+
                  You MUST Know What You are Doing
   Check Convergence of Planar Average Value on Vacuum-Thickness!
 +---------------------------------------------------------------+
 ===================== Specified Direction =======================
 Which Direction is for the Planar Average?
 1) x Direction
 2) y Direction
 3) z Direction

 0) Quit
 9) Back
 ------------&gt;&gt;
1
  --&gt;&gt; (01) Reading Structural Parameters from LOCPOT File...
  --&gt;&gt; (02) Reading Local Potential From LOCPOT File...
 Please input the period length to calculate macroscopic average:
 (Typical value: the minimum length of repeated unit.)

 ------------&gt;&gt;
1.5
 Please input iteration number to get smoother macroscopic curve:
 (Must be integer. You can gradually increase from 1 to 3.)

 ------------&gt;&gt;
3
  --&gt;&gt; (03) Written PLANAR_AVERAGE.dat File!
 +-------------------------- Summary ----------------------------+
 Maximum of macroscopic average:   0.099
 Minimum of macroscopic average:  -0.101
 +---------------------------------------------------------------+
  --&gt;&gt; (04) Written MACROSCOPIC_AVERAGE.dat File!
</pre></div>
</div>
<p><strong>Step 3</strong>. Draw graphs from the output <code class="docutils literal notranslate"><span class="pre">MACROSCOPIC_AVERAGE.dat</span></code>, and
<code class="docutils literal notranslate"><span class="pre">PLANAR_AVERAGE.dat</span></code></p>
<a class="reference internal image-reference" href="_images/avgpot4.png"><img alt="_images/avgpot4.png" class="align-center" src="_images/avgpot4.png" style="width: 914.4px; height: 123.6px;" /></a>
<a class="reference internal image-reference" href="_images/avgpot5.png"><img alt="_images/avgpot5.png" class="align-center" src="_images/avgpot5.png" style="width: 1050.0px; height: 630.0px;" /></a>
</div>
</div>
<div class="section" id="density-related">
<h2>10 Density related<a class="headerlink" href="#density-related" title="Permalink to this headline">¶</a></h2>
<div class="section" id="charge-density-and-spin-density">
<h3>10.1 Charge Density and Spin Density<a class="headerlink" href="#charge-density-and-spin-density" title="Permalink to this headline">¶</a></h3>
<p>When use spin-polarized parameter (SPIN = 2), the output CHGCAR will
contain charge density and spin density. VASPKIT can extract the charge
density and spin density by options <code class="docutils literal notranslate"><span class="pre">311</span></code> and <code class="docutils literal notranslate"><span class="pre">312</span></code> respectively.
Outputs are saved in <code class="docutils literal notranslate"><span class="pre">CHARGE.vasp</span></code> and <code class="docutils literal notranslate"><span class="pre">SPIN.vasp</span></code>.</p>
<p>VASPKIT can also calculate the Spin-Up &amp; Spin-Down density by option
<code class="docutils literal notranslate"><span class="pre">313</span></code>. The outputs are saved in <code class="docutils literal notranslate"><span class="pre">SPIN_UP.vasp</span></code> &amp; <code class="docutils literal notranslate"><span class="pre">SPIN_DW.vasp</span></code>
files</p>
</div>
<div class="section" id="charge-density-difference">
<h3>10.2 Charge Density Difference<a class="headerlink" href="#charge-density-difference" title="Permalink to this headline">¶</a></h3>
<p>VASPKIT is powerful for post-processing grid file from VASP, such as
CHGCAR, ELFCAR, LOCPOT, PARCHG.</p>
<p>CHGCAR contains the lattice vectors, atomic coordinates, the total
charge density multiplied by the volume on the fine FFT-grid
(NG(X,Y,Z)F), and the PAW one-center occupancies. By subtract two or
more CHGCAR, One can get the charge density difference.</p>
<p>Note: From electrostatic potential (LOCPOT), electron localization
function (ELFCAR), and partial charge (PARCHG) density difference
calculation can also be accomplished by the same method of VASPKIT.</p>
<p>Charge density difference is one of the important way to investigate
electronic structure. It can intuitively get the electron flow from the
interaction of two fragments. And explore the essence of chemical bond.
There are several forms of charge density difference.：</p>
<p>（1）The charge density of the total system subtract the density of two
or more segments that make up it：</p>
<div class="math notranslate nohighlight">
\[\Delta \rho=\rho_{A B}-\rho_{A}-\rho_{B}\]</div>
<p>（2）Charge density difference before and after self-consistent
calculation. Also known as deformation charge density:</p>
<div class="math notranslate nohighlight">
\[\Delta \rho=\rho\left(A B_{\text { self-consistent }}\right)-\rho\left(A B_{\text { atomic }}\right)\]</div>
<p>（3）Density in one electronic state subtracts density in another. For
example, the charge density under an applied electric field subtracts
the charge density without an external electric field. Another example
is the density of the excited state minus the density of the ground
state.</p>
<div class="math notranslate nohighlight">
\[\Delta \rho=\rho\left(A B_{\text { state 1 }}\right)-\rho\left(A B_{\text { state 0 }}\right)\]</div>
<p>Among the three charge density differences mentioned above, no matter
which calculation, must ensure that the <strong>cell parameters and
coordinates of atoms must be consistent</strong>.</p>
<div class="section" id="example-charge-density-difference-of-two-fragments">
<h4>Example: Charge density difference of two fragments<a class="headerlink" href="#example-charge-density-difference-of-two-fragments" title="Permalink to this headline">¶</a></h4>
<p>Take CO adsorption on Ni(100) surface as an example：</p>
<ol class="arabic simple">
<li><p>Optimize the structure of <strong>CO/Ni(100)</strong>，</p></li>
<li><p>Do the single-point self-consistent calculation of Ni(100) and CO
respectively. <strong>ATTENTION</strong>: The atomic position of CO and Ni(100)
fragments should be taken from optimized CO/Ni(100) CONTCAR, do NOT
optimized the CO and Ni(100) fragments！</p></li>
<li><p>Run VASPKIT <code class="docutils literal notranslate"><span class="pre">314</span></code>. to input the path of three CHGCAR respectively:</p></li>
</ol>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>314
 ======================= File Options ============================
 Input the Names of Charge/Potential Files with Space:
 (e.g., to get AB-A-B, type: ~/AB/CHGCAR ./A/CHGCAR ../B/CHGCAR)
 (e.g., to get A-B, type: ~/A/CHGCAR ./B/CHGCAR)

 ------------&gt;&gt;
./CHGCAR ./co/CHGCAR ./slab/CHGCAR

  --&gt;&gt; (01) Reading Structural Parameters from ./CHGCAR File...
  --&gt;&gt; (02) Reading Charge Density From ./CHGCAR File...
  --&gt;&gt; (03) Reading Structural Parameters from ./co/CHGCAR File...
  --&gt;&gt; (04) Reading Charge Density From ./co/CHGCAR File...
  --&gt;&gt; (05) Reading Structural Parameters from ./slab/CHGCAR File...
  --&gt;&gt; (06) Reading Charge Density From ./slab/CHGCAR File...
  --&gt;&gt; (07) Written CHGDIFF.vasp File!
</pre></div>
</div>
<p>The output CHGDIFF.vasp is also a grid that can be opened by VESTA.</p>
<a class="reference internal image-reference" href="_images/chgdiff1.png"><img alt="_images/chgdiff1.png" class="align-center" src="_images/chgdiff1.png" style="width: 540.0px; height: 445.6px;" /></a>
</div>
<div class="section" id="example-deformation-charge-density-of-co">
<h4>Example: Deformation charge density of CO<a class="headerlink" href="#example-deformation-charge-density-of-co" title="Permalink to this headline">¶</a></h4>
<ol class="arabic simple">
<li><p>Do self-consistent calculation for CO molecule.</p></li>
<li><p>Make a new folder, do non-selfconsistent calculations to output a
superposition of atomic charge densities.</p></li>
<li><p>Run VASPKIT <code class="docutils literal notranslate"><span class="pre">314</span></code> Input the path of two CHGCAR respectively.</p></li>
</ol>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>314
 ======================= File Options ============================
 Input the Names of Charge/Potential Files with Space:
 (e.g., to get AB-A-B, type: ~/AB/CHGCAR ./A/CHGCAR ../B/CHGCAR)
 (e.g., to get A-B, type: ~/A/CHGCAR ./B/CHGCAR)

 ------------&gt;&gt;
./CHGCAR ./deform/CHGCAR

  --&gt;&gt; (01) Reading Structural Parameters from ./CHGCAR File...
  --&gt;&gt; (02) Reading Charge Density From ./CHGCAR File...
  --&gt;&gt; (03) Reading Structural Parameters from ./deform/CHGCAR File...
  --&gt;&gt; (04) Reading Charge Density From ./deform/CHGCAR File...
  --&gt;&gt; (05) Written CHGDIFF.vasp File!
</pre></div>
</div>
<ol class="arabic" start="4">
<li><p>Output the CHGDIFF.vasp file and open it by VESTA.</p>
<div class="math notranslate nohighlight">
\[\Delta \rho=\rho\left(A B_{\text { self-consistent }}\right)-\rho\left(A B_{\text { atomic }}\right)\]</div>
</li>
</ol>
<a class="reference internal image-reference" href="_images/chgdiff2.png"><img alt="_images/chgdiff2.png" class="align-center" src="_images/chgdiff2.png" style="width: 604.8px; height: 414.0px;" /></a>
</div>
<div class="section" id="example-charge-density-difference-of-inse-with-electric-field">
<h4>Example: Charge density difference of InSe with electric field<a class="headerlink" href="#example-charge-density-difference-of-inse-with-electric-field" title="Permalink to this headline">¶</a></h4>
<ol class="arabic simple">
<li><p>Optimized the InSe structure with no external electric field.</p></li>
<li><p>Do self-consistent single-point calculation based the optimized
structure.</p></li>
</ol>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>EFIELD = 0.05
IDIPOL = 3
LDIPOL = .TRUE.
</pre></div>
</div>
<p>EFIELD controls the magnitude of the applied electric force field in
units of eV/Å.</p>
<p>(3)：Run VASPKIT <code class="docutils literal notranslate"><span class="pre">314</span></code> do charge density difference.</p>
<ol class="arabic simple" start="4">
<li><p>Output the CHGDIFF.vasp file and open it by VESTA.</p></li>
</ol>
<a class="reference internal image-reference" href="_images/chgdiff3.png"><img alt="_images/chgdiff3.png" class="align-center" src="_images/chgdiff3.png" style="width: 664.0px; height: 375.5px;" /></a>
</div>
</div>
<div class="section" id="wavefunction-visualization-in-real-space">
<h3>10.3 WaveFunction Visualization in Real-Space<a class="headerlink" href="#wavefunction-visualization-in-real-space" title="Permalink to this headline">¶</a></h3>
<p>VASPKIT can extract the planewave coefficients of Kohn-Sham (KS) orbital
from the WAVECAR file and output the real-space wavefunction. Users need
to input which K point to plot, and which band to plot.</p>
<p>Note: Now, VASPKIT can only output wavefunction for specified one
K-point and one band at one time. To sum several K points or seting the
energy range, the partial charge density calculation in the VASP can do
it.</p>
<div class="section" id="example-wavefunction-of-co-molecule">
<h4>Example: WaveFunction of CO molecule<a class="headerlink" href="#example-wavefunction-of-co-molecule" title="Permalink to this headline">¶</a></h4>
<ol class="arabic simple">
<li><p>Check the band structure or <code class="docutils literal notranslate"><span class="pre">IBZKPT</span></code> file to check which K point
do you want to plot? For CO molecule calculation, there is only one
Gamma point. So input <code class="docutils literal notranslate"><span class="pre">1</span></code></p></li>
</ol>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> Which K-POINT do you want to plot? (1&lt;= ikpt &lt;=1)

 ------------&gt;&gt;
1
</pre></div>
</div>
<ol class="arabic" start="2">
<li><p>Check the band structure or <code class="docutils literal notranslate"><span class="pre">EIGENVAL</span></code> file to check which band do
you want to plot? The EIGENVAL file shows as following. The five
colume are 1, band number; 2, spin up band energy; 3, spin down band
energy; 4, spin up occupation number; 5, spin down occupation
number.</p>
<p>1 -29.245473 -29.245473 1.000000 1.000000 2 -14.032873 -14.032873
1.000000 1.000000 3 -11.728864 -11.728864 1.000000 1.000000 4
-11.728864 -11.728864 1.000000 1.000000 5 -9.029100 -9.029099
1.000000 1.000000 6 -2.131725 -2.131723 0.000000 0.000000 7
-2.131725 -2.131723 0.000000 0.000000 8 -0.143054 -0.143371 0.000000
0.000000 If we want to check the HOMO and LUMO or VBM and CBM,
select band 5, 6, 7 in turn.</p>
</li>
</ol>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>511
 +-------------------------- Warm Tips --------------------------+
     Open Real-Space WaveFunction Files with VESTA/VMD Package.
 +---------------------------------------------------------------+
 Which K-POINT do you want to plot? (1&lt;= ikpt &lt;=1)

 ------------&gt;&gt;
1
 Which BAND do you want to plot? (1&lt;= iband &lt;=36)

 ------------&gt;&gt;
5
 +-------------------------- Warm Tips --------------------------+
   Current Version Only Support the Stardard Version of VASP code.
 +---------------------------------------------------------------+
  --&gt;&gt; (01) Reading the header information in WAVECAR file...
 +--------------------- WAVECAR Header --------------------------+
 SPIN =    2
 NKPTS =    1
 NBANDS =  36
 ENCUT =   400.00
 Coefficients Precision: Complex*8
 Maximum number of G values: GX =   25, GY =   25, GZ =   25
 Estimated maximum number of plane-waves:   65450
 +---------------------------------------------------------------+
  --&gt;&gt; (02) Start to Post-Process Wavefunctions...
  --&gt;&gt; (03) Reading Structural Parameters from POSCAR File...
  --&gt;&gt; (04) Written RWAV_B0005_K0001_UP.vasp File!
  --&gt;&gt; (05) Written IWAV_B0005_K0001_UP.vasp File!
  --&gt;&gt; (06) Written RWAV_B0005_K0001_DW.vasp File!
  --&gt;&gt; (07) Written IWAV_B0005_K0001_DW.vasp File!

Note: Now, VASPKIT can only output wavefunction for specified one K points and one band at one time. To sum several K points or seting the energy range, VASP partial charge calculation can do it.
</pre></div>
</div>
<p>The output file format is VASP grid file that is same as CHGCAR, and can
be opened by VESTA.</p>
<a class="reference internal image-reference" href="_images/MO_CO.png"><img alt="_images/MO_CO.png" class="align-center" src="_images/MO_CO.png" style="width: 493.5px; height: 344.0px;" /></a>
<p><code class="docutils literal notranslate"><span class="pre">RWAV</span></code> is real part of wavefunction and <code class="docutils literal notranslate"><span class="pre">IWAV</span></code> is imaginary part of
wavefunction. Usually, we just need to plot and analyze the real part.
<code class="docutils literal notranslate"><span class="pre">B0005</span></code> is band number, <code class="docutils literal notranslate"><span class="pre">K0001</span></code> is K point number in IBZKPT file.
Spin up and spin down are output seperately.</p>
<p>Show <code class="docutils literal notranslate"><span class="pre">RWAV_B0005_K0001_UP.vasp</span></code>, <code class="docutils literal notranslate"><span class="pre">RWAV_B0006_K0001_UP.vasp</span></code>, and
<code class="docutils literal notranslate"><span class="pre">RWAV_B0007_K0001_UP.vasp</span></code>… files by VESTA.</p>
</div>
<div class="section" id="example-wavefunction-of-mos2-ws2-heterojuctions">
<h4>Example: WaveFunction of MoS2/WS2 Heterojuctions<a class="headerlink" href="#example-wavefunction-of-mos2-ws2-heterojuctions" title="Permalink to this headline">¶</a></h4>
<p>Check the <code class="docutils literal notranslate"><span class="pre">IBZKPT</span></code> file and <code class="docutils literal notranslate"><span class="pre">EIGENVAL</span></code> file. The <code class="docutils literal notranslate"><span class="pre">EIGENVAL</span></code> shows
the VBM and CBM at Gamma is:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>...
  287       -2.799024   1.000000
  288       -2.799005   1.000000
  289       -0.201544   0.000000
  290       -0.201541   0.000000
...
</pre></div>
</div>
<p>Extract the <code class="docutils literal notranslate"><span class="pre">288</span></code> and <code class="docutils literal notranslate"><span class="pre">289</span></code> bands at Gamma point. Run VASPKIT, input
<code class="docutils literal notranslate"><span class="pre">511-1-288</span></code> and <code class="docutils literal notranslate"><span class="pre">511-1-289</span></code>. Open the <code class="docutils literal notranslate"><span class="pre">RWAV</span></code> files by VESTA.</p>
<a class="reference internal image-reference" href="_images/MO_TMDs.png"><img alt="_images/MO_TMDs.png" class="align-center" src="_images/MO_TMDs.png" style="width: 808.5px; height: 209.5px;" /></a>
</div>
</div>
</div>
<div class="section" id="other-functions">
<h2>11 Other Functions<a class="headerlink" href="#other-functions" title="Permalink to this headline">¶</a></h2>
<div class="section" id="molecular-dynamics-process">
<h3>11.1 Molecular Dynamics process<a class="headerlink" href="#molecular-dynamics-process" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">721</span></code> calculate the Mean Squared Displacement (MSD) based on VASP MD
results. First prepare a reference structure file <code class="docutils literal notranslate"><span class="pre">POSCAR.ref</span></code>. Then
run VASPKIT <code class="docutils literal notranslate"><span class="pre">721</span></code> to calculate MSD. The output <code class="docutils literal notranslate"><span class="pre">MSD.dat</span></code> contains
displacement information |x|, |y|, |z|, and MSD, RMSD.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># ion_step        |dx|            |dy|            |dz|            MSD          sqrt(MSD)
    1          0.0000016       0.0000011       0.0000019       0.0000000       0.0000001
    2          0.1724941       0.2677518       0.2270937       0.0001325       0.0115120
    3          0.3367914       0.5283185       0.4461284       0.0005124       0.0226364
    4          0.4918222       0.7752755       0.6499894       0.0010922       0.0330486
    5          0.6370632       1.0074569       0.8382370       0.0018188       0.0426475
    6          0.7959320       1.2340219       1.0093023       0.0026613       0.0515876
    7          0.9545851       1.4665808       1.1630884       0.0036234       0.0601945
    8          1.1064692       1.6957629       1.3186163       0.0047342       0.0688057
    9          1.2477962       1.9293770       1.4885940       0.0060285       0.0776432
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">ATOM_DISPLACEMENT.dat</span></code> contains displacement and RMSD information for
each atoms.</p>
<p><code class="docutils literal notranslate"><span class="pre">722</span></code> calculate the Radial Distribution Function (RDF) also based on
VASP MD results.</p>
</div>
<div class="section" id="file-format-transfer">
<h3>11.2 File Format Transfer<a class="headerlink" href="#file-format-transfer" title="Permalink to this headline">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 22%" />
<col style="width: 56%" />
<col style="width: 22%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>From</p></th>
<th class="head"><p>to</p></th>
<th class="head"><p>VASPKIT Option</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>XDATCAR</p></td>
<td><p>PDB</p></td>
<td><p>405</p></td>
</tr>
<tr class="row-odd"><td><p>POSCAR/CONTCAR</p></td>
<td><p>POSCAR (with Cartesian Coordinates)</p></td>
<td><p>4061</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p>POSCAR (with Fractional Coordinates)</p></td>
<td><p>4062</p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td><p>CIF (POSCAR.cif)</p></td>
<td><p>4063</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p>ATAT (lat.in) (experimental)</p></td>
<td><p>4064</p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td><p>XCrySDen (POSCAR.xsf)</p></td>
<td><p>4065</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p>Quantum-Espresso (pwscf.in)</p></td>
<td><p>4066</p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td><p>Elk (elk.in)</p></td>
<td><p>4067</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p>Siesta (POSCAR.fdf)</p></td>
<td><p>4068</p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td><p>PDB Format (POSCAR.pdb)</p></td>
<td><p>4069</p></td>
</tr>
<tr class="row-even"><td><p>CIF</p></td>
<td><p>POSCAR</p></td>
<td><p>105</p></td>
</tr>
<tr class="row-odd"><td><p>xsd</p></td>
<td><p>POSCAR</p></td>
<td><p>106</p></td>
</tr>
<tr class="row-even"><td><p>Bader results</p></td>
<td><p>pqr</p></td>
<td><p>508</p></td>
</tr>
<tr class="row-odd"><td><p>CHGCAR/PARCHG</p></td>
<td><p>XcrySDen (.xsf) format</p></td>
<td><p>318</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p>Gaussian (.cube) format</p></td>
<td><p>319</p></td>
</tr>
<tr class="row-odd"><td><p>LOCPOT/ELFCAR</p></td>
<td><p>XcrySDen (.xsf) format</p></td>
<td><p>428</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p>XcrySDen (.xsf) format</p></td>
<td><p>429</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="user-interface">
<h3>11.3 USER interface<a class="headerlink" href="#user-interface" title="Permalink to this headline">¶</a></h3>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="changelog.html" class="btn btn-neutral float-right" title="Release notes" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="installation.html" class="btn btn-neutral float-left" title="Installation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, VASPKIT Development Team

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>